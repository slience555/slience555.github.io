<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>消息初步分析 | Akesu</title><meta name="author" content="Akesu"><meta name="copyright" content="Akesu"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="1.AddBalance接收方均为f05，消息发送方给f05转账 目的描述：将收到的值存入托管的余额中。 官方代码注解 &#x2F;&#x2F; Deposits the received value into the balance held in escrow. 将收到的值存入托管的余额中。  12345参数：		eg:				&quot;f01287&quot;		&#x2F;&#x2F;消息发送方的矿工地址   &#x2F;&#x2F;在最初的版本">
<meta property="og:type" content="article">
<meta property="og:title" content="消息初步分析">
<meta property="og:url" content="http://example.com/%E6%B6%88%E6%81%AF%E5%88%9D%E6%AD%A5%E5%88%86%E6%9E%90/index.html">
<meta property="og:site_name" content="Akesu">
<meta property="og:description" content="1.AddBalance接收方均为f05，消息发送方给f05转账 目的描述：将收到的值存入托管的余额中。 官方代码注解 &#x2F;&#x2F; Deposits the received value into the balance held in escrow. 将收到的值存入托管的余额中。  12345参数：		eg:				&quot;f01287&quot;		&#x2F;&#x2F;消息发送方的矿工地址   &#x2F;&#x2F;在最初的版本">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg">
<meta property="article:published_time" content="2021-03-24T03:29:41.551Z">
<meta property="article:modified_time" content="2021-03-24T03:29:43.442Z">
<meta property="article:author" content="Akesu">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://example.com/%E6%B6%88%E6%81%AF%E5%88%9D%E6%AD%A5%E5%88%86%E6%9E%90/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2021-03-24 11:29:43'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    })(window)</script><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="Akesu" type="application/atom+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">10</div></a></div></div></div><hr/></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Akesu</a></span><div id="menus"><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">消息初步分析</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2021-03-24T03:29:41.551Z" title="Created 2021-03-24 11:29:41">2021-03-24</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2021-03-24T03:29:43.442Z" title="Updated 2021-03-24 11:29:43">2021-03-24</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="消息初步分析"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post View:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h3 id="1-AddBalance"><a href="#1-AddBalance" class="headerlink" title="1.AddBalance"></a>1.AddBalance</h3><p>接收方均为f05，消息发送方给f05转账</p>
<h4 id="目的描述："><a href="#目的描述：" class="headerlink" title="目的描述："></a>目的描述：</h4><p>将收到的值存入托管的余额中。</p>
<h4 id="官方代码注解"><a href="#官方代码注解" class="headerlink" title="官方代码注解"></a>官方代码注解</h4><blockquote>
<p>// Deposits the received value into the balance held in escrow.</p>
<p>将收到的值存入托管的余额中。</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">参数：</span><br><span class="line">		eg:</span><br><span class="line">				<span class="string">&quot;f01287&quot;</span>		<span class="comment">//消息发送方的矿工地址   </span></span><br><span class="line"><span class="comment">//在最初的版本，第一条此类型的消息参数值是发送方的地址，后面几乎均为矿工</span></span><br><span class="line">				</span><br></pre></td></tr></table></figure>

<blockquote>
<p>该参数为字符串解析后为字符串 可通过全节点接口 StateDecodeParams 直接解析参数,后续消息参数也可使用该接口解析，不过返回的类型是interface{}</p>
</blockquote>
<p>消息的value为转账给f05的金额</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">返回值：</span><br><span class="line">		无</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="2-AddLockedFund"><a href="#2-AddLockedFund" class="headerlink" title="2.AddLockedFund"></a>2.AddLockedFund</h3><p>普通账户给其账户下的矿工发送的消息，增加锁仓金额</p>
<h4 id="目的描述：-1"><a href="#目的描述：-1" class="headerlink" title="目的描述："></a>目的描述：</h4><p>锁定矿工的未锁定余额（包括与调用消息一起收到的资金）。</p>
<h4 id="官方代码注解："><a href="#官方代码注解：" class="headerlink" title="官方代码注解："></a>官方代码注解：</h4><blockquote>
<p>// Locks up some amount of the miner’s unlocked balance (including funds received alongside the invoking message).</p>
<p>锁定矿工的未锁定余额（包括与调用消息一起收到的资金）。</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">参数：</span><br><span class="line">		eg:</span><br><span class="line">				<span class="string">&quot;12000000000000000000&quot;</span>		<span class="comment">//消息的value值   （字符串，不是结构体）</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>该参数为字符串解析后为字符串 可通过全节点接口 StateDecodeParams 直接解析参数</p>
</blockquote>
<p>消息的value为转账给其账户下的矿工的金额</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">返回值：</span><br><span class="line">		无</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="3-AddVerifiedClient"><a href="#3-AddVerifiedClient" class="headerlink" title="3.AddVerifiedClient"></a>3.AddVerifiedClient</h3><p>接收方均为f06，（注册确认）</p>
<h4 id="目的描述：-2"><a href="#目的描述：-2" class="headerlink" title="目的描述："></a>目的描述：</h4><p>增加经过验证的客户。</p>
<blockquote>
<p>To further incentivize the storage of “useful” data over simple capacity commitments, storage miners have the additional opportunity to compete for special deals offered by verified clients. Such clients are certified with respect to their intent to offer deals involving the storage of meaningful data, and the power a storage miner earns for these deals is augmented by a multiplier.</p>
<p>为了通过简单的容量承诺进一步激励“有用”数据的存储，存储矿工有额外的机会竞争经过验证的客户提供的特殊交易。此类客户在提供涉及存储有意义数据的交易意图方面获得了认证，并且乘以乘数可以增强存储矿工为这些交易赚取的权力。</p>
</blockquote>
<h4 id="官方代码注解：-1"><a href="#官方代码注解：-1" class="headerlink" title="官方代码注解："></a>官方代码注解：</h4><blockquote>
<p>// The caller will be verified by checking the verifiers table below.</p>
<p>// Validate caller is one of the verifiers.</p>
<p>// Validate client to be added isn’t a verifier</p>
<p>// Compute new verifier cap and update.</p>
<p>// This is a one-time, upfront allocation.<br>       // This allowance cannot be changed by calls to AddVerifiedClient as long as the client has not been removed.<br>       // If parties need more allowance, they need to create a new verified client or use up the the current allowance<br>       // and then create a new verified client.</p>
<p>1.通过检查下面的验证程序表，可以验证呼叫者。<br>2.验证调用者是验证者之一。<br>3.验证要添加的客户端不是验证者<br>4.计算新的验证者上限并更新<br>5.这是一次性的前期分配。只要没有删除客户端，就不能通过调用AddVerifiedClient来更改此限额。如果各方需要更多的配额，则需要创建一个新的经过验证的客户或用完当前的配额,然后创建一个新的经过验证的客户端。</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">参数：</span><br><span class="line">		eg:</span><br><span class="line">				&#123;</span><br><span class="line">          <span class="string">&quot;Address&quot;</span>:<span class="string">&quot;f3ulwcfkdp7cqtvyfrfigr6yjmpil5bpas2w7q5iw7ck4dlmuquybvwnbct3yhfjmdbkj7xjdiblhmxgwg5yqq&quot;</span>,</span><br><span class="line">          <span class="string">&quot;Allowance&quot;</span>: <span class="string">&quot;8589934592&quot;</span> <span class="comment">//津贴</span></span><br><span class="line">				&#125;</span><br></pre></td></tr></table></figure>

<p>消息解析：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">消息参数对应结构体</span><br><span class="line"><span class="keyword">type</span> AddVerifiedClientParams <span class="keyword">struct</span> &#123;</span><br><span class="line">	Address   addr.Address</span><br><span class="line">	Allowance DataCap</span><br><span class="line">&#125; </span><br><span class="line">解参eg:</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">decodeAddVerifiedClient</span><span class="params">(c context.Context, apii api.FullNode)</span></span> &#123;</span><br><span class="line">    decode, err := cid.Decode(<span class="string">&quot;bafy2bzaceciqezv7ijf24ncawtlv7ulyqeegdssw3xrphmm2nsgxgvauljbl2&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    message, err := apii.ChainGetMessage(c, decode)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> cc verifreg.AddVerifiedClientParams</span><br><span class="line">    err = cc.UnmarshalCBOR(bytes.NewBuffer(message.Params))</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    fmt.Println(cc)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">返回值：</span><br><span class="line">		无</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="4-Approve"><a href="#4-Approve" class="headerlink" title="4.Approve"></a>4.Approve</h3><h4 id="目的描述：-3"><a href="#目的描述：-3" class="headerlink" title="目的描述："></a>目的描述：</h4><p>批准多重签名交易</p>
<h4 id="官方代码注解：-2"><a href="#官方代码注解：-2" class="headerlink" title="官方代码注解："></a>官方代码注解：</h4><blockquote>
<p>Approve a multisig transaction. The “hash” is optional.</p>
<p>批准多重签名交易。 “哈希”是可选的</p>
<p>// if the transaction already has enough approvers, execute it without “processing” this approval.</p>
<p>//如果交易已经有足够的批准者，则执行该交易而无需“处理”该批准。</p>
<p>// if the transaction hasn’t already been approved, let’s “process” this approval<br>// and see if we can execute the transaction<br>//如果交易尚未获得批准，让我们“处理”此批准<br>//并查看是否可以执行交易</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">参数：</span><br><span class="line">eg:</span><br><span class="line">				&#123;</span><br><span class="line">          <span class="string">&quot;TxId&quot;</span>: <span class="number">198</span>,</span><br><span class="line">          <span class="string">&quot;ProposalHash&quot;</span>: <span class="string">&quot;&quot;</span></span><br><span class="line">				&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>消息参数解析</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">消息参数对应结构体</span><br><span class="line"><span class="keyword">type</span> TxnIDParams <span class="keyword">struct</span> &#123;</span><br><span class="line">  <span class="comment">// TxnID is the ID of the proposed transaction</span></span><br><span class="line">	ID TxnID</span><br><span class="line">	<span class="comment">// Optional hash of proposal to ensure an operation can only apply to a</span></span><br><span class="line">	<span class="comment">// specific proposal.</span></span><br><span class="line">	ProposalHash []<span class="keyword">byte</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">decodeApprove</span><span class="params">(c context.Context, apii api.FullNode)</span></span> &#123;</span><br><span class="line">    decode, err := cid.Decode(<span class="string">&quot;bafy2bzaceabq2bam6t5jj5tzjtsm2q7kaom2xkjkblv45bdhey6bfcjrcv2e6&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    message, err := apii.ChainGetMessage(c, decode)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> cc multisig.TxnIDParams</span><br><span class="line">    err = cc.UnmarshalCBOR(bytes.NewBuffer(message.Params))</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    fmt.Println(cc)</span><br><span class="line"></span><br><span class="line">    tipSet, err := apii.ChainGetTipSetByHeight(c, abi.ChainEpoch(<span class="number">593700</span>), types.EmptyTSK)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    replay, err := apii.StateReplay(c, tipSet.Key(), decode)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> aa multisig.ApproveReturn</span><br><span class="line">    err = aa.UnmarshalCBOR(bytes.NewBuffer(replay.MsgRct.Return))</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    fmt.Println(aa)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">返回值：</span><br><span class="line">		&#123;</span><br><span class="line">      <span class="string">&quot;Applied&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="string">&quot;ExitCode&quot;</span>: <span class="number">0</span>,</span><br><span class="line">      <span class="string">&quot;Ret&quot;</span>: <span class="string">&quot;&quot;</span></span><br><span class="line">		&#125;</span><br></pre></td></tr></table></figure>

<p>返回值解析</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> ApproveReturn <span class="keyword">struct</span> &#123;</span><br><span class="line">	<span class="comment">// Applied indicates if the transaction was applied as opposed to proposed but not applied due to lack of approvals</span></span><br><span class="line">	Applied <span class="keyword">bool</span></span><br><span class="line">	<span class="comment">// Code is the exitcode of the transaction, if Applied is false this field should be ignored.</span></span><br><span class="line">	Code exitcode.ExitCode</span><br><span class="line">	<span class="comment">// Ret is the return vale of the transaction, if Applied is false this field should be ignored.</span></span><br><span class="line">	Ret []<span class="keyword">byte</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">decodeApprove</span><span class="params">(c context.Context, apii api.FullNode)</span></span> &#123;</span><br><span class="line">    decode, err := cid.Decode(<span class="string">&quot;bafy2bzaceabq2bam6t5jj5tzjtsm2q7kaom2xkjkblv45bdhey6bfcjrcv2e6&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    message, err := apii.ChainGetMessage(c, decode)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> cc multisig.TxnIDParams</span><br><span class="line">    err = cc.UnmarshalCBOR(bytes.NewBuffer(message.Params))</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    fmt.Println(cc)</span><br><span class="line"></span><br><span class="line">    tipSet, err := apii.ChainGetTipSetByHeight(c, abi.ChainEpoch(<span class="number">593700</span>), types.EmptyTSK)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    replay, err := apii.StateReplay(c, tipSet.Key(), decode)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> aa multisig.ApproveReturn</span><br><span class="line">    err = aa.UnmarshalCBOR(bytes.NewBuffer(replay.MsgRct.Return))</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    fmt.Println(aa)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<hr>
<h3 id="5-Cancel"><a href="#5-Cancel" class="headerlink" title="5.Cancel"></a>5.Cancel</h3><h4 id="目的描述：-4"><a href="#目的描述：-4" class="headerlink" title="目的描述："></a>目的描述：</h4><p>取消交易</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">参数：</span><br><span class="line">		eg:</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="string">&quot;TxId&quot;</span>: <span class="number">23</span>,</span><br><span class="line">        <span class="string">&quot;ProposalHash&quot;</span>: <span class="string">&quot;xWOo+yB0Npov4/rYIMcTfmnlXgBLv6/cpAqAx8omoUU=&quot;</span></span><br><span class="line">      &#125;</span><br></pre></td></tr></table></figure>

<p>消息参数解析</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> TxnIDParams <span class="keyword">struct</span> &#123;</span><br><span class="line">	ID TxnID</span><br><span class="line">	<span class="comment">// Optional hash of proposal to ensure an operation can only apply to a</span></span><br><span class="line">	<span class="comment">// specific proposal.</span></span><br><span class="line">	ProposalHash []<span class="keyword">byte</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">decodeCancel</span><span class="params">(c context.Context, apii api.FullNode)</span></span> &#123;</span><br><span class="line">    decode, err := cid.Decode(<span class="string">&quot;bafy2bzaceczuzt3bx6pbqkihww3s4yffbzknj3prvopgl6wauqrp4w5exd6ck&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    message, err := apii.ChainGetMessage(c, decode)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> cc multisig.TxnIDParams</span><br><span class="line">    err = cc.UnmarshalCBOR(bytes.NewBuffer(message.Params))</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    fmt.Println(cc)</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">返回值：</span><br><span class="line">		无</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="6-ChangeMultiaddrs"><a href="#6-ChangeMultiaddrs" class="headerlink" title="6.ChangeMultiaddrs"></a>6.ChangeMultiaddrs</h3><p>修改矿工 multiaddress。</p>
<h4 id="目的描述：-5"><a href="#目的描述：-5" class="headerlink" title="目的描述："></a>目的描述：</h4><p>修改矿工 multiaddress。</p>
<h4 id="调用参数"><a href="#调用参数" class="headerlink" title="调用参数"></a>调用参数</h4><p> <em>NewMultiAddrs</em> 新的 multiaddress 列表。</p>
<h4 id="返回值"><a href="#返回值" class="headerlink" title="返回值"></a>返回值</h4><p>无</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Libp2p MultiAddress</span><br></pre></td></tr></table></figure>

<p>更改矿工libp2p地址</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">参数：</span><br><span class="line">		eg:</span><br><span class="line">				&#123;</span><br><span class="line">          <span class="string">&quot;NewMultiaddrs&quot;</span>: [</span><br><span class="line">            <span class="string">&quot;BHt2irgGXcI=&quot;</span></span><br><span class="line">          ]</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>

<p>消息参数解析</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> ChangeMultiaddrsParams <span class="keyword">struct</span> &#123;</span><br><span class="line">	NewMultiaddrs []abi.Multiaddrs</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">changeMultisigAddress</span><span class="params">(c context.Context, apii api.FullNode)</span></span> &#123;</span><br><span class="line">    decode, err := cid.Decode(<span class="string">&quot;bafy2bzacechzv4ytabwdwb4ggle3alccc4ehry6maazumimll3koackbkjkie&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    message, err := apii.ChainGetMessage(c, decode)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> cc minerr.ChangeMultiaddrsParams</span><br><span class="line">    err = cc.UnmarshalCBOR(bytes.NewBuffer(message.Params))</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="built_in">len</span>(cc.NewMultiaddrs); i++ &#123;</span><br><span class="line">        multiaddrBytes, err := multiaddr.NewMultiaddrBytes(cc.NewMultiaddrs[i])</span><br><span class="line">        <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">            fmt.Println(err)</span><br><span class="line">        &#125;</span><br><span class="line">        fmt.Println(multiaddrBytes.String())</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">返回值：</span><br><span class="line">		无</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="7-ChangeOwnerAddress"><a href="#7-ChangeOwnerAddress" class="headerlink" title="7.ChangeOwnerAddress"></a>7.ChangeOwnerAddress</h3><h4 id="目的描述：-6"><a href="#目的描述：-6" class="headerlink" title="目的描述："></a>目的描述：</h4><p>更改矿工owner地址</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">参数：</span><br><span class="line">		eg:</span><br><span class="line">				&#123;  </span><br><span class="line">					&quot;f0417633&quot; &#x2F;&#x2F;矿工地址</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>

<p>参数解析</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">changeOwnerAddress</span><span class="params">(c context.Context, apii api.FullNode)</span></span> &#123;</span><br><span class="line">    decode, err := cid.Decode(<span class="string">&quot;bafy2bzacedipmlzyaupk63uilaqmcguqsekfjw6kbcohs5k4otmfsjr5jtlqq&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    message, err := apii.ChainGetMessage(c, decode)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    height, err := apii.ChainGetTipSetByHeight(c, abi.ChainEpoch(<span class="number">582838</span>), types.EmptyTSK)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    params, err := apii.StateDecodeParams(c, message.To, abi.MethodNum(<span class="number">23</span>), message.Params, height.Key())</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    fmt.Println(params)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">返回值：</span><br><span class="line">		无</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="8-ChangePeerID"><a href="#8-ChangePeerID" class="headerlink" title="8.ChangePeerID"></a>8.ChangePeerID</h3><h4 id="目的描述：-7"><a href="#目的描述：-7" class="headerlink" title="目的描述："></a>目的描述：</h4><p>更改矿工的PeerID</p>
<h4 id="调用参数-1"><a href="#调用参数-1" class="headerlink" title="调用参数"></a>调用参数</h4><p> <em>NewID</em> 新的 PeerID。</p>
<h4 id="返回值-1"><a href="#返回值-1" class="headerlink" title="返回值"></a>返回值</h4><p>无</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">参数：</span><br><span class="line">		eg:		</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="string">&quot;NewID&quot;</span>: <span class="string">&quot;ACQIARIg5Z6wcl1jmIURfqclMJJ8p+7gysbOgvLa7JFqHi/hd1Q=&quot;</span></span><br><span class="line">      &#125;</span><br></pre></td></tr></table></figure>

<p>消息参数解析</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">type</span> ChangePeerIDParams <span class="keyword">struct</span> &#123;</span><br><span class="line">	NewID abi.PeerID</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">changePeerId</span><span class="params">(c context.Context, apii api.FullNode)</span></span> &#123;</span><br><span class="line">    decode, err := cid.Decode(<span class="string">&quot;bafy2bzacec5hwvey334lyvxyges4rrr4eildrk3kp6bx3ag5cn3cefnnfghgg&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    message, err := apii.ChainGetMessage(c, decode)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> cc minerr.ChangePeerIDParams</span><br><span class="line">    err = cc.UnmarshalCBOR(bytes.NewBuffer(message.Params))</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    fromBytes, err := peer.IDFromBytes(cc.NewID)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    fmt.Println(fromBytes)</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">返回值：</span><br><span class="line">		无</span><br><span class="line">	</span><br></pre></td></tr></table></figure>



<hr>
<h3 id="9-ChangeWorkerAddress"><a href="#9-ChangeWorkerAddress" class="headerlink" title="9.ChangeWorkerAddress"></a>9.ChangeWorkerAddress</h3><h4 id="目的描述：-8"><a href="#目的描述：-8" class="headerlink" title="目的描述："></a>目的描述：</h4><p>更改矿工worker地址</p>
<h4 id="调用参数-2"><a href="#调用参数-2" class="headerlink" title="调用参数"></a>调用参数</h4><p> <em>NewWorker</em> 新的 Worker。</p>
<h4 id="返回值-2"><a href="#返回值-2" class="headerlink" title="返回值"></a>返回值</h4><p>无</p>
<h4 id="官方代码注解：-3"><a href="#官方代码注解：-3" class="headerlink" title="官方代码注解："></a>官方代码注解：</h4><blockquote>
<p>// ChangeWorkerAddress will ALWAYS overwrite the existing control addresses with the control addresses passed in the params.<br>// If a nil addresses slice is passed, the control addresses will be cleared.<br>// A worker change will be scheduled if the worker passed in the params is different from the existing worker.</p>
<p>// ChangeWorkerAddress将始终用在参数中传递的控制地址覆盖现有的控制地址。<br>//如果传递了零地址切片，则将清除控制地址。<br>//如果在参数中传递的工人与现有工人不同，则将安排工人更换。</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">参数：</span><br><span class="line">		eg:</span><br><span class="line">				</span><br><span class="line">gkQAqb0Zg1gxA7NhailOLDOtoh/vkFINR46QUWTxYOz+LpjtzVIwDdLQJd7S5I9xQvBtqArFhpmqQlgxA5OwKeo9/kK66vYM1IKT5v7SGYjYqT/alE1PypqKdx+Kxfay/<span class="number">37863</span>Xp1JmOyy0B7VgxA5I0juri718y6XYlORkgwQNHgQNxp7W1qo4MuQ0yEMIeMh2WJIBT7IY222ys/M5E5w==</span><br></pre></td></tr></table></figure>

<p>参数解析</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> ChangeWorkerAddressParams <span class="keyword">struct</span> &#123;</span><br><span class="line">	NewWorker       addr.Address</span><br><span class="line">	NewControlAddrs []addr.Address</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">changeWorkerAddress</span><span class="params">(c context.Context, apii api.FullNode)</span></span> &#123;</span><br><span class="line">    decode, err := cid.Decode(<span class="string">&quot;bafy2bzacebpptviyjddf6wrddeay6o7d26qhlwj7i6egrebpnybwvmqfizssq&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    message, err := apii.ChainGetMessage(c, decode)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> cc minerr.ChangeWorkerAddressParams</span><br><span class="line">    err = cc.UnmarshalCBOR(bytes.NewBuffer(message.Params))</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//fmt.Println(params)</span></span><br><span class="line">    fmt.Println(cc)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">返回值：</span><br><span class="line">		无</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="10-Collect"><a href="#10-Collect" class="headerlink" title="10.Collect"></a>10.Collect</h3><p>大部分都有个错误信息，小部分消息状态为ok</p>
<p>接收方均为支付通道</p>
<p>通过“ Collect（）”支付的付款渠道成功赎回了金额</p>
<h4 id="目的描述：-9"><a href="#目的描述：-9" class="headerlink" title="目的描述："></a>目的描述：</h4><p>收集/汇总</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">参数：</span><br><span class="line">		eg:</span><br><span class="line">				无</span><br></pre></td></tr></table></figure>



<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">返回值：</span><br><span class="line">		无</span><br></pre></td></tr></table></figure>

<blockquote>
<p>当前有的错误类型有：<br>   SysErrInvalidReceiver，ErrForbidden,SysErrForbidden 等</p>
</blockquote>
<hr>
<h3 id="11-CompactSectorNumbers"><a href="#11-CompactSectorNumbers" class="headerlink" title="11.CompactSectorNumbers"></a>11.CompactSectorNumbers</h3><h4 id="目的描述：-10"><a href="#目的描述：-10" class="headerlink" title="目的描述："></a>目的描述：</h4><p>压缩扇区号分配以减小分配的扇区号位字段的大小。</p>
<p>当按顺序或按顺序分配扇区号时，这时位域应保持很小。但是，如果位域变大此方法足以使PreCommitSector失败（或变得昂贵），<br>此方法可以调用以屏蔽（丢弃）所有未使用的扇区ID。<br>例如，如果分配了扇区1-99和101-200，则扇区号<br>可以屏蔽99，以将这两个范围合并为一个。</p>
<h4 id="官方代码注解：-4"><a href="#官方代码注解：-4" class="headerlink" title="官方代码注解："></a>官方代码注解：</h4><blockquote>
<p>// Compacts sector number allocations to reduce the size of the allocated sector<br>// number bitfield.<br>//<br>// When allocating sector numbers sequentially, or in sequential groups, this<br>// bitfield should remain fairly small. However, if the bitfield grows large<br>// enough such that PreCommitSector fails (or becomes expensive), this method<br>// can be called to mask out (throw away) entire ranges of unused sector IDs.<br>// For example, if sectors 1-99 and 101-200 have been allocated, sector number<br>// 99 can be masked out to collapse these two ranges into one.</p>
<p>压缩扇区号分配以减小分配的扇区号位字段的大小。<br>当按顺序或按顺序分配扇区号时，这时位域应保持很小。但是，如果位域变大此方法足以使PreCommitSector失败（或变得昂贵），<br>此方法可以调用以屏蔽（丢弃）所有未使用的扇区ID。<br>例如，如果分配了扇区1-99和101-200，则扇区号<br>可以屏蔽99，以将这两个范围合并为一个。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">参数：</span><br><span class="line">		eg:</span><br><span class="line">				&#123;&quot;MaskSectorNumber&quot;: &quot;0-1052999&quot;&#125;</span><br></pre></td></tr></table></figure>



<p>参数解析：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> CompactSectorNumbersParams <span class="keyword">struct</span> &#123;</span><br><span class="line">	MaskSectorNumbers bitfield.BitField</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">decodeCompactSectorNumbers</span><span class="params">(c context.Context, apii api.FullNode)</span></span> &#123;</span><br><span class="line">    decode, err := cid.Decode(<span class="string">&quot;bafy2bzaceavj4na57qhi6opp2zuiukj5pncd5v4nz2n3x6snvp2shr2v2eq6k&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    message, err := apii.ChainGetMessage(c, decode)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> cc minerr.CompactSectorNumbersParams</span><br><span class="line">    err = cc.UnmarshalCBOR(bytes.NewBuffer(message.Params))</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    fmt.Println(cc)</span><br><span class="line">    iterator, err := cc.MaskSectorNumbers.BitIterator()</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    fmt.Println(iterator.Next())</span><br><span class="line">    fmt.Println(cc.MaskSectorNumbers.Last())</span><br><span class="line">    fmt.Println(cc.MaskSectorNumbers.First())</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">返回值：</span><br><span class="line">		无</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="12-ConfirmUpdateWorkerKey"><a href="#12-ConfirmUpdateWorkerKey" class="headerlink" title="12.ConfirmUpdateWorkerKey"></a>12.ConfirmUpdateWorkerKey</h3><h4 id="目的描述：-11"><a href="#目的描述：-11" class="headerlink" title="目的描述："></a>目的描述：</h4><blockquote>
<p>Confirmed worker address change whether reflected on chain</p>
<p>确认worker address 变更是否反应在链上</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">参数：</span><br><span class="line">		eg:</span><br><span class="line">				无</span><br></pre></td></tr></table></figure>



<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">返回值：</span><br><span class="line">		无</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="13-Constructor"><a href="#13-Constructor" class="headerlink" title="13.Constructor"></a>13.Constructor</h3><p>此类消息绝大部份也都有错误信息一项</p>
<h4 id="目的描述：-12"><a href="#目的描述：-12" class="headerlink" title="目的描述："></a>目的描述：</h4><p>创建账户时调用的构造函数。</p>
<h4 id="官方代码注解：-5"><a href="#官方代码注解：-5" class="headerlink" title="官方代码注解："></a>官方代码注解：</h4><blockquote>
<p>// Storage miner actors are created exclusively by the storage power actor. In order to break a circular dependency<br>// between the two, the construction parameters are defined in the power actor.</p>
<p>//存储矿工actor由storage power actor专门创建。为了打破循环依赖<br>//在这两者之间，构造参数是在power actor者中定义的。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">参数：</span><br><span class="line">		eg:</span><br><span class="line">				无</span><br></pre></td></tr></table></figure>



<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">返回值：</span><br><span class="line">		无</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="14-ControlAddresses"><a href="#14-ControlAddresses" class="headerlink" title="14.ControlAddresses"></a>14.ControlAddresses</h3><h4 id="目的描述：-13"><a href="#目的描述：-13" class="headerlink" title="目的描述："></a>目的描述：</h4><p>获取矿工 Owner 和 Worker 地址。</p>
<h4 id="调用参数-3"><a href="#调用参数-3" class="headerlink" title="调用参数"></a>调用参数</h4><p>无</p>
<h4 id="返回值-3"><a href="#返回值-3" class="headerlink" title="返回值"></a>返回值</h4><p> <em>Owner</em> Owner 地址； <em>Worker</em> Worker 地址。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">参数：</span><br><span class="line">		eg:</span><br><span class="line">				无</span><br></pre></td></tr></table></figure>



<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">返回值：</span><br><span class="line">		&#123;</span><br><span class="line">      <span class="string">&quot;Owner&quot;</span>: <span class="string">&quot;f050468&quot;</span>,</span><br><span class="line">      <span class="string">&quot;Worker&quot;</span>: <span class="string">&quot;f050501&quot;</span>,</span><br><span class="line">      <span class="string">&quot;ControlAddrs&quot;</span>: [</span><br><span class="line">        <span class="string">&quot;f023997&quot;</span></span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>返回值解析：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> GetControlAddressesReturn <span class="keyword">struct</span> &#123;</span><br><span class="line">	Owner        addr.Address</span><br><span class="line">	Worker       addr.Address</span><br><span class="line">	ControlAddrs []addr.Address</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">decodeControllerAddress</span><span class="params">(c context.Context, apii api.FullNode)</span></span> &#123;</span><br><span class="line">  decode, err := cid.Decode(<span class="string">&quot;bafy2bzaced4qxa246o7hilmbfy5k5l34ykswkisk74qmln7txruzs4kkhvpg6&quot;</span>)</span><br><span class="line">  <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">    fmt.Println(err)</span><br><span class="line">  &#125;</span><br><span class="line">	tipSet, err := apii.ChainGetTipSetByHeight(c, abi.ChainEpoch(<span class="number">205716</span>), types.EmptyTSK)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(err)</span><br><span class="line">	&#125;</span><br><span class="line">	replay, err := apii.StateReplay(c, tipSet.Key(), decode)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(err)</span><br><span class="line">	&#125;</span><br><span class="line">    <span class="keyword">var</span> cc minerr.GetControlAddressesReturn</span><br><span class="line">    err = cc.UnmarshalCBOR(bytes.NewBuffer(replay.MsgRct.Return))</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    fmt.Println(cc)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<hr>
<h3 id="15-CreateMiner"><a href="#15-CreateMiner" class="headerlink" title="15.CreateMiner"></a>15.CreateMiner</h3><h4 id="目的描述：-14"><a href="#目的描述：-14" class="headerlink" title="目的描述："></a>目的描述：</h4><p>用于创建矿工，接收方统一为f04</p>
<p>内部调用 <em>Exec</em> 创建矿工账户，创建成功后将金额 <em>Value</em> 转移至矿工账户。</p>
<h4 id="调用参数-4"><a href="#调用参数-4" class="headerlink" title="调用参数"></a>调用参数</h4><p> <em>Owner</em> 矿工的拥有者，管钱； <em>Worker</em> 负责挖矿计算的地址； <em>SealProofType</em> 表示矿工的扇区大小等信息； <em>Peer</em> 矿工的 PeerID。 <em>Multiaddrs</em> 矿工的 multiaddress 列表，可以用来连接矿工节点。</p>
<h4 id="返回值-4"><a href="#返回值-4" class="headerlink" title="返回值"></a>返回值</h4><p> <em>IDAddress</em> 新创建账户的 ID 格式地址，地址前缀 t0； <em>RobustAddress</em> 新创建账户的 Hash 格式地址，该格式不会被分叉影响。地址前缀 t2。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">参数：</span><br><span class="line">		eg:</span><br><span class="line">				</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;Owner&quot;</span>: <span class="string">&quot;f3qvr6cwew2xeeay4ilwzkirk2dfjxbpvzfyg7frnkuava7qv2lxiq72ryzdmrjirw3h2ydeq5uvhmba7la64q&quot;</span>,</span><br><span class="line">  <span class="string">&quot;Worker&quot;</span>: <span class="string">&quot;f3qvr6cwew2xeeay4ilwzkirk2dfjxbpvzfyg7frnkuava7qv2lxiq72ryzdmrjirw3h2ydeq5uvhmba7la64q&quot;</span>,</span><br><span class="line">  <span class="string">&quot;SealProofType&quot;</span>: <span class="number">8</span>,</span><br><span class="line">  <span class="string">&quot;PeerId&quot;</span>: <span class="string">&quot;ACQIARIgQZkkMrCT6L97G+kb9o5ypYaF08qtpv/lJvKmmGmq6CM=&quot;</span>,</span><br><span class="line">  <span class="string">&quot;MultiAddresses&quot;</span>: []</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>参数解析：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> CreateMinerParams <span class="keyword">struct</span> &#123;</span><br><span class="line">	Owner         addr.Address</span><br><span class="line">	Worker        addr.Address</span><br><span class="line">	SealProofType abi.RegisteredSealProof</span><br><span class="line">	Peer          abi.PeerID</span><br><span class="line">	Multiaddrs    []abi.Multiaddrs</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">decodeF04Message</span><span class="params">(ctx context.Context, api api.FullNode, db *gorm.DB)</span></span> &#123;</span><br><span class="line">    decode, err := cid.Decode(<span class="string">&quot;bafy2bzacebq6bwcwpkmvi7wv5bhtqrdelqgpfb5t7yfsg4slkeqyrycqpjjeq&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="literal">nil</span> != err &#123;</span><br><span class="line">       fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    fmt.Println(time.Now())</span><br><span class="line">    height, err := api.ChainGetTipSetByHeight(ctx, abi.ChainEpoch(<span class="number">5000</span>), types.EmptyTSK)</span><br><span class="line">    <span class="keyword">if</span> <span class="literal">nil</span> != err &#123;</span><br><span class="line">       fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    message, _ := api.ChainGetMessage(ctx, decode)</span><br><span class="line">    params, _ := api.StateDecodeParams(ctx, message.To, message.Method, message.Params, height.Key())</span><br><span class="line">    fmt.Println(params)</span><br><span class="line">    minerParams := power.CreateMinerParams&#123;&#125;</span><br><span class="line">    minerParams.UnmarshalCBOR(bytes.NewBuffer(message.Params))</span><br><span class="line">    fmt.Println(minerParams)</span><br><span class="line"> 		<span class="keyword">var</span> execReturn init2.ExecReturn</span><br><span class="line">    replay, err := api.StateReplay(ctx, height.Key(), decode)</span><br><span class="line">    <span class="keyword">if</span> <span class="literal">nil</span> != err &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    err = execReturn.UnmarshalCBOR(bytes.NewReader(replay.MsgRct.Return))</span><br><span class="line">    <span class="keyword">if</span> <span class="literal">nil</span> != err &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    fmt.Println(execReturn)</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">返回值：</span><br><span class="line">		&#123;</span><br><span class="line">      <span class="string">&quot;IdAddress&quot;</span>: <span class="string">&quot;f0417848&quot;</span>,</span><br><span class="line">      <span class="string">&quot;RobustAddress&quot;</span>: <span class="string">&quot;f26e3yuwp2scqayq5oq3iiqj4j2gvegbundyj7rxy&quot;</span></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>返回值解析</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> ExecReturn <span class="keyword">struct</span> &#123;</span><br><span class="line">	IDAddress     addr.Address <span class="comment">// The canonical ID-based address for the actor.</span></span><br><span class="line">	RobustAddress addr.Address <span class="comment">// A more expensive but re-org-safe address for the newly created actor.</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">decodeF04Message</span><span class="params">(ctx context.Context, api api.FullNode, db *gorm.DB)</span></span> &#123;</span><br><span class="line">    decode, err := cid.Decode(<span class="string">&quot;bafy2bzacebq6bwcwpkmvi7wv5bhtqrdelqgpfb5t7yfsg4slkeqyrycqpjjeq&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="literal">nil</span> != err &#123;</span><br><span class="line">       fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    fmt.Println(time.Now())</span><br><span class="line">    height, err := api.ChainGetTipSetByHeight(ctx, abi.ChainEpoch(<span class="number">5000</span>), types.EmptyTSK)</span><br><span class="line">    <span class="keyword">if</span> <span class="literal">nil</span> != err &#123;</span><br><span class="line">       fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    message, _ := api.ChainGetMessage(ctx, decode)</span><br><span class="line">    params, _ := api.StateDecodeParams(ctx, message.To, message.Method, message.Params, height.Key())</span><br><span class="line">    fmt.Println(params)</span><br><span class="line">    minerParams := power.CreateMinerParams&#123;&#125;</span><br><span class="line">    minerParams.UnmarshalCBOR(bytes.NewBuffer(message.Params))</span><br><span class="line">    fmt.Println(minerParams)</span><br><span class="line"> 		<span class="keyword">var</span> execReturn init2.ExecReturn</span><br><span class="line">    replay, err := api.StateReplay(ctx, height.Key(), decode)</span><br><span class="line">    <span class="keyword">if</span> <span class="literal">nil</span> != err &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    err = execReturn.UnmarshalCBOR(bytes.NewReader(replay.MsgRct.Return))</span><br><span class="line">    <span class="keyword">if</span> <span class="literal">nil</span> != err &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    fmt.Println(execReturn)</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="16-DeclareFaults"><a href="#16-DeclareFaults" class="headerlink" title="16.DeclareFaults"></a>16.DeclareFaults</h3><h4 id="目的描述：-15"><a href="#目的描述：-15" class="headerlink" title="目的描述："></a>目的描述：</h4><p>用于宣告扇区错误,时空证明检测错误扇区</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">参数：</span><br><span class="line">		eg:</span><br><span class="line">				</span><br><span class="line">&#123;</span><br><span class="line">  </span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;Faults&quot;</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">&quot;Deadline&quot;</span>: <span class="number">47</span>,</span><br><span class="line">      <span class="string">&quot;Partition&quot;</span>: <span class="number">0</span>,</span><br><span class="line">      <span class="string">&quot;Sectors&quot;</span>: <span class="string">&quot;108682,108702,108712,108726,108735,108741-108742,108751,108759,108836,108841,108848,108851-108852,108856-108857,108937,110055,110067,110118,110166,110192,110195,110201,110206,110209,110215,110218,110220,110222,110225-110234,110236,110239-110255,110257-110258,110260-110267,110269-110276,110278,110280-110281,110284-110285,110287,110289-110291,110295,110297-110298,111580,111584,111595-111597,111603,111608,111616,111619,111621,111624,111627-111628,111630,111634-111635,111640,111642,111646,111649-111650,111655,111657-111662,111665-111668,111673,111675-111676,111680,111684,111686,111694,111697,111703-111706,111708,111716-111718,111720,111732-111735,111737-111738,111741-111742,111752-111757,111759,111761,111763,112340,112343,112346,112352,112358-112359,112363,112365,112404,112415,112418-112419,112421-112422,112425,112433,112437,112439-112442,112445-112446,112449,112455,112461,112463,112465,112470,112472,112478-112479,112482-112483,112485,112488-112799&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;<span class="string">&quot;Owner&quot;</span>: <span class="string">&quot;f3qvr6cwew2xeeay4ilwzkirk2dfjxbpvzfyg7frnkuava7qv2lxiq72ryzdmrjirw3h2ydeq5uvhmba7la64q&quot;</span>,</span><br><span class="line">  <span class="string">&quot;Worker&quot;</span>: <span class="string">&quot;f3qvr6cwew2xeeay4ilwzkirk2dfjxbpvzfyg7frnkuava7qv2lxiq72ryzdmrjirw3h2ydeq5uvhmba7la64q&quot;</span>,</span><br><span class="line">  <span class="string">&quot;SealProofType&quot;</span>: <span class="number">8</span>,</span><br><span class="line">  <span class="string">&quot;PeerId&quot;</span>: <span class="string">&quot;ACQIARIgQZkkMrCT6L97G+kb9o5ypYaF08qtpv/lJvKmmGmq6CM=&quot;</span>,</span><br><span class="line">  <span class="string">&quot;MultiAddresses&quot;</span>: []</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>参数解析</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> DeclareFaultsParams <span class="keyword">struct</span> &#123;</span><br><span class="line">	Faults []FaultDeclaration</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">type</span> FaultDeclaration <span class="keyword">struct</span> &#123;</span><br><span class="line">	<span class="comment">// The deadline to which the faulty sectors are assigned, in range [0..WPoStPeriodDeadlines)</span></span><br><span class="line">	Deadline <span class="keyword">uint64</span></span><br><span class="line">	<span class="comment">// Partition index within the deadline containing the faulty sectors.</span></span><br><span class="line">	Partition <span class="keyword">uint64</span></span><br><span class="line">	<span class="comment">// Sectors in the partition being declared faulty.</span></span><br><span class="line">	Sectors bitfield.BitField</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">decodeDeclareFaults</span><span class="params">(c context.Context, apii api.FullNode)</span></span> &#123;</span><br><span class="line">    decode, err := cid.Decode(<span class="string">&quot;bafy2bzacedretykpp6puetth6zjbcbmogxvocru4zqotwpvnc5p2y2f3bxjjc&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    message, err := apii.ChainGetMessage(c, decode)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> cc minerr.DeclareFaultsParams</span><br><span class="line">    err = cc.UnmarshalCBOR(bytes.NewBuffer(message.Params))</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    fmt.Println(cc)</span><br><span class="line">    <span class="keyword">for</span> _, v := <span class="keyword">range</span> cc.Faults &#123;</span><br><span class="line">        fmt.Println(v)</span><br><span class="line">        <span class="comment">//iterator, err := v.Sectors.BitIterator()</span></span><br><span class="line">        <span class="comment">//if err != nil &#123;</span></span><br><span class="line">        <span class="comment">//    fmt.Println(err)</span></span><br><span class="line">        <span class="comment">//&#125;</span></span><br><span class="line">        fmt.Println(v.Sectors.Count())</span><br><span class="line">        fmt.Println(v.Sectors.Last())</span><br><span class="line">        fmt.Println(v.Sectors.First())</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">返回值：</span><br><span class="line">		无</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="17-DeclareFaultsRecovered"><a href="#17-DeclareFaultsRecovered" class="headerlink" title="17.DeclareFaultsRecovered"></a>17.DeclareFaultsRecovered</h3><h4 id="目的描述：-16"><a href="#目的描述：-16" class="headerlink" title="目的描述："></a>目的描述：</h4><p>宣告错误扇区恢复，时空证明恢复扇区</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">参数：</span><br><span class="line">		eg:</span><br><span class="line">				</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;Recoveries&quot;</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">&quot;Deadline&quot;</span>: <span class="number">9</span>,</span><br><span class="line">      <span class="string">&quot;Partition&quot;</span>: <span class="number">0</span>,</span><br><span class="line">      <span class="string">&quot;Sectors&quot;</span>: <span class="string">&quot;1074,20977,22854&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">&quot;Deadline&quot;</span>: <span class="number">9</span>,</span><br><span class="line">      <span class="string">&quot;Partition&quot;</span>: <span class="number">1</span>,</span><br><span class="line">      <span class="string">&quot;Sectors&quot;</span>: <span class="string">&quot;110843,115284,115719,116036&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">&quot;Deadline&quot;</span>: <span class="number">9</span>,</span><br><span class="line">      <span class="string">&quot;Partition&quot;</span>: <span class="number">2</span>,</span><br><span class="line">      <span class="string">&quot;Sectors&quot;</span>: <span class="string">&quot;233416&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>参数解析</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> DeclareFaultsRecoveredParams <span class="keyword">struct</span> &#123;</span><br><span class="line">	Recoveries []RecoveryDeclaration</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> RecoveryDeclaration <span class="keyword">struct</span> &#123;</span><br><span class="line">	<span class="comment">// The deadline to which the recovered sectors are assigned, in range [0..WPoStPeriodDeadlines)</span></span><br><span class="line">	Deadline <span class="keyword">uint64</span></span><br><span class="line">	<span class="comment">// Partition index within the deadline containing the recovered sectors.</span></span><br><span class="line">	Partition <span class="keyword">uint64</span></span><br><span class="line">	<span class="comment">// Sectors in the partition being declared recovered.</span></span><br><span class="line">	Sectors bitfield.BitField</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">decodeDeclareFaultsRecovered</span><span class="params">(c context.Context, apii api.FullNode)</span></span> &#123;</span><br><span class="line">    decode, err := cid.Decode(<span class="string">&quot;bafy2bzacea6lwnrow5mctt3zabjw7lqoxj52qhoadukouyimmfdcftwd32sho&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    message, err := apii.ChainGetMessage(c, decode)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> cc minerr.DeclareFaultsRecoveredParams</span><br><span class="line">    err = cc.UnmarshalCBOR(bytes.NewBuffer(message.Params))</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    fmt.Println(cc)</span><br><span class="line">    <span class="keyword">for</span> _, v := <span class="keyword">range</span> cc.Recoveries &#123;</span><br><span class="line">        fmt.Println(v)</span><br><span class="line">        <span class="comment">//iterator, err := v.Sectors.BitIterator()</span></span><br><span class="line">        <span class="comment">//if err != nil &#123;</span></span><br><span class="line">        <span class="comment">//    fmt.Println(err)</span></span><br><span class="line">        <span class="comment">//&#125;</span></span><br><span class="line">        fmt.Println(v.Sectors.Count())</span><br><span class="line">        fmt.Println(v.Sectors.Last())</span><br><span class="line">        fmt.Println(v.Sectors.First())</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">返回值：</span><br><span class="line">		无</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="18-DisputeWindowedPoSt"><a href="#18-DisputeWindowedPoSt" class="headerlink" title="18.DisputeWindowedPoSt"></a>18.DisputeWindowedPoSt</h3><h4 id="目的描述：-17"><a href="#目的描述：-17" class="headerlink" title="目的描述："></a>目的描述：</h4><p>（时空证明争议）大多数会有错误信息</p>
<h4 id="官方注释："><a href="#官方注释：" class="headerlink" title="官方注释："></a>官方注释：</h4><blockquote>
<p>// Note: these are going to be slightly inaccurate as time<br>// will have moved on from when the post was actually submitted.<br>// However, these are estimates <em>anyways</em>.</p>
<p>//注意：随着时间的推移，这些内容将有些不准确<br>//从实际发布时开始提交。<br>//不过，这些都是_anyways_的估算值。</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">参数：</span><br><span class="line">		eg:</span><br><span class="line">				</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;Deadline&quot;</span>: <span class="number">26</span>,</span><br><span class="line">  <span class="string">&quot;PoStIndex&quot;</span>: <span class="number">1</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>参数解析</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> DisputeWindowedPoStParams <span class="keyword">struct</span> &#123;</span><br><span class="line">	Deadline  <span class="keyword">uint64</span></span><br><span class="line">	PoStIndex <span class="keyword">uint64</span> <span class="comment">// only one is allowed at a time to avoid loading too many sector infos.</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">decodeDisputeWindowedPoSt</span><span class="params">(c context.Context, apii api.FullNode)</span></span> &#123;</span><br><span class="line">    decode, err := cid.Decode(<span class="string">&quot;bafy2bzaceazkdsv53i6vca6xdk6ejeshiysuzd56yy3a76nrqlsbq4oc2brxy&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    message, err := apii.ChainGetMessage(c, decode)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> cc miner.DisputeWindowedPoStParams</span><br><span class="line">    err = cc.UnmarshalCBOR(bytes.NewBuffer(message.Params))</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    fmt.Println(cc)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">返回值：</span><br><span class="line">		无</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="19-Exec"><a href="#19-Exec" class="headerlink" title="19.Exec"></a>19.Exec</h3><h4 id="目的描述：-18"><a href="#目的描述：-18" class="headerlink" title="目的描述："></a>目的描述：</h4><p>消息接收方均为f01</p>
<p>创建特殊类型的账户，例如 Multisig, PaymentChannel 等，创建成功后将金额 Value 转移至新创建的账户。</p>
<h4 id="调用参数-5"><a href="#调用参数-5" class="headerlink" title="调用参数"></a>调用参数</h4><p> <em>CodeCID</em> 所创建账户类型的 CID 格式； <em>ConstructorParams</em> 创建账户的 <em>Constructor</em> 消息参数。</p>
<h4 id="返回值-5"><a href="#返回值-5" class="headerlink" title="返回值"></a>返回值</h4><p> <em>IDAddress</em> 新创建账户的 ID 格式地址，地址前缀 t0； <em>RobustAddress</em> 新创建账户的 Hash 格式地址，该格式不会被分叉影响。地址前缀 t2。</p>
<h4 id="官方代码注释："><a href="#官方代码注释：" class="headerlink" title="官方代码注释："></a>官方代码注释：</h4><blockquote>
<p>// Compute a re-org-stable address.<br>   // This address exists for use by messages coming from outside the system, in order to<br>   // stably address the newly created actor even if a chain re-org causes it to end up with<br>   // a different ID.</p>
<p>//计算一个重新组织稳定的地址。<br>//此地址存在，供系统外的消息使用，以便<br>//稳定地解决新创建的actor，即使链重组导致其最终以<br>//不同的ID。</p>
<p>   // Allocate an ID for this actor.</p>
<p>   为actor分配一个ID</p>
<p>   // Store mapping of pubkey or actor address to actor ID<br>   存储pubkey或actor地址到actor ID的映射</p>
<p>   // Create an empty actor.<br>   创建一个空的actor</p>
<p>   // Invoke constructor.<br>   调用construct</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">参数：</span><br><span class="line">		eg:</span><br><span class="line">				</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;CodeCid&quot;</span>: <span class="string">&quot;bafkqafdgnfwc6mzpobqxs3lfnz2gg2dbnzxgk3a&quot;</span>,</span><br><span class="line">  <span class="string">&quot;ConstructorParams&quot;</span>: <span class="string">&quot;glgxA5MXq0/0yCIkaemuYg9xgHo0c0lnnS2K3Mq6NDCEGb0v0lGh6hg3aro+MLLHYnk7BEQAyqcB&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>参数与返回值解析</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> ExecParams <span class="keyword">struct</span> &#123;</span><br><span class="line">	CodeCID           cid.Cid <span class="string">`checked:&quot;true&quot;`</span> <span class="comment">// invalid CIDs won&#x27;t get committed to the state tree</span></span><br><span class="line">	ConstructorParams []<span class="keyword">byte</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> ExecReturn <span class="keyword">struct</span> &#123;</span><br><span class="line">	IDAddress     addr.Address <span class="comment">// The canonical ID-based address for the actor.</span></span><br><span class="line">	RobustAddress addr.Address <span class="comment">// A more expensive but re-org-safe address for the newly created actor.</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> ConstructorParams <span class="keyword">struct</span> &#123;</span><br><span class="line">	Signers               []addr.Address</span><br><span class="line">	NumApprovalsThreshold <span class="keyword">uint64</span></span><br><span class="line">	UnlockDuration        abi.ChainEpoch</span><br><span class="line">&#125;  (测试时出现过解析到该结构体失败的情况，案例中有给出另一种获取方法)</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">decodeMultisigMessage</span><span class="params">(ctx context.Context, apii api.FullNode)</span></span> &#123;</span><br><span class="line">    decode, err := cid.Decode(<span class="string">&quot;bafy2bzacecdrmgvdwn24cl53uhl63iglpqz4z332tzavbrsu2r2bdxe4736tu&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    message, err := apii.ChainGetMessage(ctx, decode)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    height, err := apii.ChainGetTipSetByHeight(ctx, abi.ChainEpoch(<span class="number">573070</span>), types.EmptyTSK)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    execParams := init2.ExecParams&#123;&#125;</span><br><span class="line">    execParams.UnmarshalCBOR(bytes.NewBuffer(message.Params))</span><br><span class="line">    multisgParams := multisig.ConstructorParams&#123;&#125;</span><br><span class="line">    multisgParams.UnmarshalCBOR(bytes.NewBuffer(execParams.ConstructorParams))</span><br><span class="line">    <span class="keyword">var</span> execReturn init2.ExecReturn</span><br><span class="line">    replay, err := apii.StateReplay(ctx, height.Key(), decode)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    err = execReturn.UnmarshalCBOR(bytes.NewReader(replay.MsgRct.Return))</span><br><span class="line">    balance, err := apii.MsigGetAvailableBalance(ctx, execReturn.IDAddress, types.EmptyTSK)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    fmt.Println(message.To)</span><br><span class="line">    actor, err := apii.StateGetActor(ctx, execReturn.IDAddress, types.EmptyTSK)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    tbs := bufbstore.NewTieredBstore(apibstore.NewAPIBlockstore(apii), blockstore.NewTemporary())</span><br><span class="line">    mas, err := muls.Load(adt.WrapStore(ctx, cbor.NewCborStore(tbs)), actor)</span><br><span class="line">    signers, err := mas.Signers()</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    fmt.Println(signers)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> _, signer := <span class="keyword">range</span> multisgParams.Signers  &#123;</span><br><span class="line">        minerInfo := table.TAccountMultsig&#123;</span><br><span class="line">            Id: execReturn.IDAddress.String(),</span><br><span class="line">            RobustAddress: execReturn.RobustAddress.String(),</span><br><span class="line">            <span class="comment">//StartEpoch: int64(parentTipSet.Height()),</span></span><br><span class="line">            AvailableBalance: balance.String(),</span><br><span class="line">            Signer: signer.String(),</span><br><span class="line">            ApprovalsThreshold: <span class="keyword">int64</span>(multisgParams.NumApprovalsThreshold),</span><br><span class="line">            UnlockDuration: <span class="keyword">int64</span>(multisgParams.UnlockDuration),</span><br><span class="line">        &#125;</span><br><span class="line">        fmt.Println(minerInfo)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">返回值：</span><br><span class="line">		</span><br><span class="line">&#123;</span><br><span class="line">  &quot;IdAddress&quot;: &quot;f0418970&quot;,</span><br><span class="line">  &quot;RobustAddress&quot;: &quot;f2hm4xmjcl2zavx7ixrcvwfa76m75nyauc5ynnffa&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<hr>
<h3 id="20-ExtendSectorExpiration"><a href="#20-ExtendSectorExpiration" class="headerlink" title="20.ExtendSectorExpiration"></a>20.ExtendSectorExpiration</h3><h4 id="目的描述：-19"><a href="#目的描述：-19" class="headerlink" title="目的描述："></a>目的描述：</h4><p>将一个扇区的到期时间更改为一个新的，更晚的时间。扇区不得终止或出现故障。为新的到期时间重新计算扇区的功率。</p>
<h4 id="官方代码注释：-1"><a href="#官方代码注释：-1" class="headerlink" title="官方代码注释："></a>官方代码注释：</h4><blockquote>
<p>// Changes the expiration epoch for a sector to a new, later one.<br>// The sector must not be terminated or faulty.<br>// The sector’s power is recomputed for the new expiration.</p>
<p>//将一个扇区的到期时间更改为一个新的，更晚的时间。<br>//扇区不得终止或出现故障。<br>//为新的到期时间重新计算扇区的功率。</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">参数：</span><br><span class="line">		eg:</span><br><span class="line">				</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;Extensions&quot;</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">&quot;Deadline&quot;</span>: <span class="number">0</span>,</span><br><span class="line">      <span class="string">&quot;Partition&quot;</span>: <span class="number">0</span>,</span><br><span class="line">      <span class="string">&quot;Sectors&quot;</span>: <span class="string">&quot;809,814,816-817,820,822,824,826-831,836,839,860,883,888-895,902,911-912,914-915,939,971,995,997-998,1002-1003,1006,1021-1023,1031,1036-1038,1046-1049,1051&quot;</span>,</span><br><span class="line">      <span class="string">&quot;NewExpiration&quot;</span>: <span class="number">1626934</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">&quot;Deadline&quot;</span>: <span class="number">1</span>,</span><br><span class="line">      <span class="string">&quot;Partition&quot;</span>: <span class="number">0</span>,</span><br><span class="line">      <span class="string">&quot;Sectors&quot;</span>: <span class="string">&quot;1045&quot;</span>,</span><br><span class="line">      <span class="string">&quot;NewExpiration&quot;</span>: <span class="number">1626934</span></span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>参数解析：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> ExtendSectorExpirationParams <span class="keyword">struct</span> &#123;</span><br><span class="line">	Extensions []ExpirationExtension</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> ExpirationExtension <span class="keyword">struct</span> &#123;</span><br><span class="line">	Deadline      <span class="keyword">uint64</span></span><br><span class="line">	Partition     <span class="keyword">uint64</span></span><br><span class="line">	Sectors       bitfield.BitField</span><br><span class="line">	NewExpiration abi.ChainEpoch</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">decodeExtendSectorExpirationParams</span><span class="params">(c context.Context, apii api.FullNode)</span></span> &#123;</span><br><span class="line">    decode, err := cid.Decode(<span class="string">&quot;bafy2bzacedxdrljmeudy5a2vh2pyu4mtyggjjsilhtm7isxu7hqxxka2fq5zu&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    message, err := apii.ChainGetMessage(c, decode)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> cc minerr.ExtendSectorExpirationParams</span><br><span class="line">    err = cc.UnmarshalCBOR(bytes.NewBuffer(message.Params))</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> _, v := <span class="keyword">range</span> cc.Extensions &#123;</span><br><span class="line">        fmt.Println(v)</span><br><span class="line">    &#125;</span><br><span class="line">    fmt.Println(cc)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">返回值：</span><br><span class="line">		</span><br><span class="line">无</span><br></pre></td></tr></table></figure>



<hr>
<h3 id="21-PreCommitSector"><a href="#21-PreCommitSector" class="headerlink" title="21.PreCommitSector"></a>21.PreCommitSector</h3><h4 id="目的描述：-20"><a href="#目的描述：-20" class="headerlink" title="目的描述："></a>目的描述：</h4><p>消息的value值会转账给消息接收方</p>
<p>矿工提交 PreCommit 信息。</p>
<h4 id="调用参数-6"><a href="#调用参数-6" class="headerlink" title="调用参数"></a>调用参数</h4><p> <em>RegisteredProof</em> <em>SectorNumber</em> Sector 序号； <em>SealedCID</em> <em>SealedRandEpoch</em> <em>DealIDs</em> <em>Expiration Sector</em> 过期时间。</p>
<h4 id="返回值-6"><a href="#返回值-6" class="headerlink" title="返回值"></a>返回值</h4><p>无</p>
<h4 id="官方代码注解：-6"><a href="#官方代码注解：-6" class="headerlink" title="官方代码注解："></a>官方代码注解：</h4><blockquote>
<p>// Proposals must be posted on chain via sma.PublishStorageDeals before PreCommitSector.<br>// Optimization: PreCommitSector could contain a list of deals that are not published yet.</p>
<p>（Proposals）投标必须在PreCommitSector之前通过sma.PublishStorageDeals在链上发布。<br>//优化：PreCommitSector可能包含尚未发布的交易列表。</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">参数：</span><br><span class="line">		eg:</span><br><span class="line">				</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;RegisteredProof&quot;</span>: <span class="number">8</span>,</span><br><span class="line">  <span class="string">&quot;SectorNumber&quot;</span>: <span class="number">16306</span>,</span><br><span class="line">  <span class="string">&quot;SealedCid&quot;</span>: <span class="string">&quot;bagboea4b5abcbptd43l6v4o7b3kn4drtjxgyvjqntvt27xy6sfem4ecitzyeffzv&quot;</span>,</span><br><span class="line">  <span class="string">&quot;SealRandEpoch&quot;</span>: <span class="number">592396</span>,</span><br><span class="line">  <span class="string">&quot;DealIds&quot;</span>: [],</span><br><span class="line">  <span class="string">&quot;Expiration&quot;</span>: <span class="number">2094328</span>,</span><br><span class="line">  <span class="string">&quot;ReplaceCapacity&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">  <span class="string">&quot;ReplaceSectorDeadline&quot;</span>: <span class="number">0</span>,</span><br><span class="line">  <span class="string">&quot;ReplaceSectorPartition&quot;</span>: <span class="number">0</span>,</span><br><span class="line">  <span class="string">&quot;ReplaceSector&quot;</span>: <span class="number">0</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>参数解析</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> SectorPreCommitInfo <span class="keyword">struct</span> &#123;</span><br><span class="line">	SealProof       abi.RegisteredSealProof</span><br><span class="line">	SectorNumber    abi.SectorNumber</span><br><span class="line">	SealedCID       cid.Cid <span class="string">`checked:&quot;true&quot;`</span> <span class="comment">// CommR</span></span><br><span class="line">	SealRandEpoch   abi.ChainEpoch</span><br><span class="line">	DealIDs         []abi.DealID</span><br><span class="line">	Expiration      abi.ChainEpoch</span><br><span class="line">	ReplaceCapacity <span class="keyword">bool</span> <span class="comment">// Whether to replace a &quot;committed capacity&quot; no-deal sector (requires non-empty DealIDs)</span></span><br><span class="line">	<span class="comment">// The committed capacity sector to replace, and it&#x27;s deadline/partition location</span></span><br><span class="line">	ReplaceSectorDeadline  <span class="keyword">uint64</span></span><br><span class="line">	ReplaceSectorPartition <span class="keyword">uint64</span></span><br><span class="line">	ReplaceSectorNumber    abi.SectorNumber</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">decodePreCommitSector</span><span class="params">(c context.Context, apii api.FullNode)</span></span> &#123;</span><br><span class="line">    decode, err := cid.Decode(<span class="string">&quot;bafy2bzacebdcez2tblorrpzhjews5l2irq6sfiyxk5zaztladet376wpp7zwi&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    message, err := apii.ChainGetMessage(c, decode)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> cc minerr.SectorPreCommitInfo</span><br><span class="line">    err = cc.UnmarshalCBOR(bytes.NewBuffer(message.Params))</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    fmt.Println(cc)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">返回值：</span><br><span class="line">		</span><br><span class="line">无</span><br></pre></td></tr></table></figure>



<hr>
<h3 id="22-Propose"><a href="#22-Propose" class="headerlink" title="22.Propose"></a>22.Propose</h3><h4 id="目的描述：-21"><a href="#目的描述：-21" class="headerlink" title="目的描述："></a>目的描述：</h4><p>消息参数的value值会转账给消息参数里指明的接收方</p>
<p>向给定的multisig提出一个事务。</p>
<p>初步观察是让指定的多签账户给消息参数中指定的To转钱</p>
<h4 id="官方代码注解：-7"><a href="#官方代码注解：-7" class="headerlink" title="官方代码注解："></a>官方代码注解：</h4><blockquote>
<p>Propose a transaction to the given multisig.</p>
<p>向给定的multisig提出一个事务。</p>
<p>// Note: this transaction ID may not be stable across chain re-orgs.<br>   // The proposal hash may be provided as a stability check when approving.</p>
<p>此交易ID在跨链重组机构中可能不稳定。</p>
<p>//提案哈希可以作为批准时的稳定性检查提供。</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">参数：</span><br><span class="line">		eg:</span><br><span class="line">				</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;To&quot;</span>: <span class="string">&quot;f1ht2ak3ctcc7faqsmwzpogr375pttlkbzeexbvpa&quot;</span>,</span><br><span class="line">  <span class="string">&quot;Value&quot;</span>: <span class="string">&quot;18903506871636894026&quot;</span>,</span><br><span class="line">  <span class="string">&quot;Method&quot;</span>: <span class="number">0</span>,</span><br><span class="line">  <span class="string">&quot;Params&quot;</span>: <span class="string">&quot;&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">返回值：</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;TxId&quot;</span>: <span class="number">307</span>,</span><br><span class="line">  <span class="string">&quot;Applied&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="string">&quot;ExitCode&quot;</span>: <span class="number">0</span>,</span><br><span class="line">  <span class="string">&quot;Ret&quot;</span>: <span class="string">&quot;&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>参数返回值解析</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> ProposeParams <span class="keyword">struct</span> &#123;</span><br><span class="line">	To     addr.Address</span><br><span class="line">	Value  abi.TokenAmount</span><br><span class="line">	Method abi.MethodNum</span><br><span class="line">	Params []<span class="keyword">byte</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> ProposeReturn <span class="keyword">struct</span> &#123;</span><br><span class="line">	<span class="comment">// TxnID is the ID of the proposed transaction</span></span><br><span class="line">	TxnID TxnID</span><br><span class="line">	<span class="comment">// Applied indicates if the transaction was applied as opposed to proposed but not applied due to lack of approvals</span></span><br><span class="line">	Applied <span class="keyword">bool</span></span><br><span class="line">	<span class="comment">// Code is the exitcode of the transaction, if Applied is false this field should be ignored.</span></span><br><span class="line">	Code exitcode.ExitCode</span><br><span class="line">	<span class="comment">// Ret is the return vale of the transaction, if Applied is false this field should be ignored.</span></span><br><span class="line">	Ret []<span class="keyword">byte</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">decodePropose</span><span class="params">(c context.Context, apii api.FullNode)</span></span> &#123;</span><br><span class="line">    decode, err := cid.Decode(<span class="string">&quot;bafy2bzacebpkaf7w6r6rxlgruuyg7xi2pyxtrinl52gng45nnwwp65ielunee&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    message, err := apii.ChainGetMessage(c, decode)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> cc multisig.ProposeParams</span><br><span class="line">    err = cc.UnmarshalCBOR(bytes.NewBuffer(message.Params))</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    fmt.Println(cc)</span><br><span class="line"></span><br><span class="line">    tipSet, err := apii.ChainGetTipSetByHeight(c, abi.ChainEpoch(<span class="number">594297</span>), types.EmptyTSK)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    replay, err := apii.StateReplay(c, tipSet.Key(), decode)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> aa multisig.ProposeReturn</span><br><span class="line">    err = aa.UnmarshalCBOR(bytes.NewBuffer(replay.MsgRct.Return))</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    fmt.Println(aa)</span><br><span class="line">    <span class="comment">//var aa multisig.ProposalHashData</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="23-ProveCommitSector"><a href="#23-ProveCommitSector" class="headerlink" title="23.ProveCommitSector"></a>23.ProveCommitSector</h3><p>矿工提交 扇区证明 信息。</p>
<p>消息的value值会转账给消息的接收方（一般都是账户下的矿工）</p>
<h4 id="目的描述：-22"><a href="#目的描述：-22" class="headerlink" title="目的描述："></a>目的描述：</h4><p>检查相应扇区预先承诺的状态，然后安排要批量验证的证据by power actor。<br>如果有效，power actor将在与此消息相同的纪元末尾调用ConfirmSectorProofsValid</p>
<p>一个矿工每个时期最多只能提交200个证明提交。在每个时期证明200个扇区，直到全部被证明。</p>
<h4 id="调用参数-7"><a href="#调用参数-7" class="headerlink" title="调用参数"></a>调用参数</h4><p> <em>SectorNumber</em> Sector 序号； <em>Proof</em></p>
<h4 id="返回值-7"><a href="#返回值-7" class="headerlink" title="返回值"></a>返回值</h4><p>无</p>
<h4 id="官方代码注解：-8"><a href="#官方代码注解：-8" class="headerlink" title="官方代码注解："></a>官方代码注解：</h4><blockquote>
<p>// Checks state of the corresponding sector pre-commitment, then schedules the proof to be verified in bulk<br>// by the power actor.<br>// If valid, the power actor will call ConfirmSectorProofsValid at the end of the same epoch as this message.</p>
<p>检查相应扇区预先承诺的状态，然后安排要批量验证的证据<br>//by power actor。<br>//如果有效，power actor将在与此消息相同的纪元末尾调用ConfirmSectorProofsValid</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">参数：</span><br><span class="line">		eg:</span><br><span class="line">				</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  &#123;</span><br><span class="line">  <span class="string">&quot;SectorNumber&quot;</span>: <span class="number">310311</span>,</span><br><span class="line">  <span class="string">&quot;Proof&quot;</span>: <span class="string">&quot;parGDT8LL9ybqvWWhJLWWizd3H8f7F51MZP4W7RCL5ozRMREUj8mcVl0xXVW+XsojPjRIfo0EH5e4+g1qStl0Hz78CwcEaVqnO+COe1qdnYB4AQt3EN11S7fV9l5Ua2+ElAIBzkr2KxElSP3Rm0GbmSk2vjdCrrh2Jn07lmgzx3uUHQulVuNxo4j0jgblgW8sdRUAUn5EcCoKYMLj43og9Tsre7zq279Te0jfdjeVw/Ug32YinehN2Wt89yBA+SJkP+oBGIIGXqUWhNm5CR4OhyZ3Sof3ydzzeS/sKrKgov2nvHVCdURXZhp627efVDsqZ+A3DXFtHfdIcayqIapKwYBvu3dzf+jtRHFh9XLhkTvI7amrWbJ7oJW24MonNgdBlZBfzUW8JO40pZ/XU85jQxQ9z4qFWuFWfho98WHyJmnj4OkT3FFEBSyUd+Xui7ZiBNnl6HK61km/B57QRrPbUYj6Q61JrG9JZ9Tu6oGxnlqfKI6FXTa20/NfEZUUSdWlw1fLlrnB6EbpAlVVHBmY5rg0940z3pzJEj5m+fEWqzum22cIW/mK4IburxSqINwkvE1O+b9YEEp2VdAM2wkyISYAEb4g/gnFAs8gamhjrJ/eZ6HQYL+LDwiaf4wJ3QbC1sse+TJMk3LLIRt8+/6N2dlmPHn2xriGPT2oJgZ1hiHYraYvSewLoepD0FFS1f+uQ+5fXz7NqwQfzV+RUhk4xMoKtEcP+0R8qxWmrYtg1062fkMlttMUYSjFOQ2v3U2i2FwT1Q/YSShpvPffyfR/lZngTM7ev+k0wKhgv6TRoJoW3PnNZJJnCx3PVAawvUbjNn7xR7uQiso8rMuRRd9Z+X1SuwHnZjE1n6PsPB38E4TIAN8XbKqVVtAjD839LDvARPzLMaKtBK5vh+zyL67IYaUd+KU1BGcBqz5s6lqUIWLtTX1fPvi6DzZJ4pBst+zpN8brjb2qZPS7OB6lK31zyVsoKDDozUaUurEkTgffr06jmvCUumoLL11DBb/eUQVjfqdkuqAF20LQ9jzbsyjCIuFd7WfZll2Z+CrMcn8WRxxNeqlY4mEyCQxmMGWyAgrrZ9h/sFTSuVzwWgxpHrl8LcoDB6ZSCMMl3lz5qfpDE1x+fmwz2BaiDVQMtqcSVHrDYu20ek6tyBmUQEEVD47RX9SErccHppYjU6L6Ezfft0AxjfAWqLFe2v766TtDgrGq7W3mG3Xa8T/YXcOsqwp5DFzTsV9Z1CNhkTHz7LQaBCJO+wK1OJOc3KdDmTOemN4t1+g6njg1mRkSBeWby2P3B/6JG3YBM81nsMqr1HEj3Lv9p+rU8vprAZp1HpRry4BsMfG55RDbq41bWZYOlbdclM2KJyslRvwgFpe9i/QSVX01dhL9C83Af/Zw+csk7QBAGVlnvFM/9/S4fRJcaLdQhE5MLnKf/xpYepushCARx/cTKCGKk28wokOh6b2nZJKjJNiaS9QSLm+NCkj8tqkflnBtIZXh8wlCx1nE2884aNCketDvkdR0MCw2HtnuHz6liAiIHWwbdBpdOXrTG0IbcefH8nMefWj5D2E5eUyHalYgVWdbSu5jrfTslHr4PkJmTQBjW9jzDMU2lR0cpkzvcOVfSp6Fr2Qf6qXUX/p4qZuuNvIZkapUsnAJ/2NjZZRDKne8lYqAppQHjbaZSb3sBmzYLx/U0zp8EkYt6/kz38ymLmiW1GMxreFLeanktLftLvl9spZye3K5gWTXIxvvlDJ2eeHoMW4wkK+cZELeXcGcsOEfbF6Il43Dif06NacluPMUbitx/STsTKUy4N2zLAXzb1TWNt+wXWEsZXGpCkA/WqinQSHSsyuNRUI49OThxo8R6eQjOhBQZ5kvg6gn3hQ5hoRPJo5G35aOudYxNlBmEly/0EJgct+8+EbKBhrEfFwDEwR/GfBec7NHAFWIQxGgLq1vc8zQNCrK+1G313p1xZVuX13KJAzYMgGzoRuqUu4HawMBC4p6iKeKpBq9+rUSzFgwpfUnZ4jUqaZJ30I4jgqe5Nb09EFrzeyQlEzgWdk3rJPciiq6bUgoYQSgY0nvPEnPI0tbzm+Ih8K5MOJ44YccxpM5WYVFj8QbeKZsyzsZCbuJ/zyTGOWsIbIFhxo7Ug2Wqa4lJmU0zNeyI681yoeEEuOMMovot9wvYgMCN53zuW4kNXDWamPpQX0yrgnBfpdo/19PopD0dfvVPRftNpiyS0mflSN4TfPHdk7rEyhpJMwTIpsA9ltr3HSWM/U+JjVJ1DLWGEEPdS8jcsifAHo8XrphTMYxc/6VpcApWk4CFZEFLSWSUZ/nAuoEWA/GTbMUl5GbEjtoI3jivev0nihxPY/Rm1rMCQKIx82pj4UqHRuuNaLJJ/5jiYnSdEUfQ3Iyi0MkMcPw3ClKrMvKA2vew0IdS2Xbs0tqUJZEImxnwrviRE2ROAtNsLfEV9T7kAPvRUrmEV8Hh71o0VG0MzpxbREwU/f56cQAvbrr7THV0/CK1aVRSLRHzRyszVQJbJhcrvYJYbd5oOYZLP8iGRUXKEq8X/FQVh+Brxb&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">返回值：</span><br><span class="line"></span><br><span class="line">无</span><br></pre></td></tr></table></figure>

<p>参数解析</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">type</span> ProveCommitSectorParams <span class="keyword">struct</span> &#123;</span><br><span class="line">	SectorNumber abi.SectorNumber</span><br><span class="line">	Proof        []<span class="keyword">byte</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">decodeProveCommitSector</span><span class="params">(c context.Context, apii api.FullNode)</span></span> &#123;</span><br><span class="line">    decode, err := cid.Decode(<span class="string">&quot;bafy2bzaceaxtai4zjwb6x6xi6u2bbfu7yqnhwptebrchtwgvrm2zwev56nfpc&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    message, err := apii.ChainGetMessage(c, decode)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> cc minerr.ProveCommitSectorParams</span><br><span class="line">    err = cc.UnmarshalCBOR(bytes.NewBuffer(message.Params))</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    fmt.Println(cc)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="24-PubkeyAddress"><a href="#24-PubkeyAddress" class="headerlink" title="24.PubkeyAddress"></a>24.PubkeyAddress</h3><p>获取公钥地址：BLS pubkey</p>
<p>消息接收方返回其地址。那么问题来了，消息都发给了对方不知道消息地址是为什么？</p>
<p>有时也会报错，错误信息例如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">not enough gas: used&#x3D;239519, available&#x3D;250000, use&#x3D;114617 (RetCode&#x3D;7)</span><br></pre></td></tr></table></figure>

<h4 id="目的描述：-23"><a href="#目的描述：-23" class="headerlink" title="目的描述："></a>目的描述：</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">参数：</span><br><span class="line">		eg:		</span><br><span class="line">Ynl0ZSBhcnJheQ&#x3D;&#x3D;（时有时无）</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">返回值：</span><br><span class="line">&quot;f3r7xigxhxcqyymqrknajhxrlnpsxmznqp5vmyx3i3l2nwaoh5zfuuuzsu25io5sdxikkltlckijbmsu4fh52a&quot;</span><br></pre></td></tr></table></figure>

<p>参数返回值解析</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>

<hr>
<h3 id="25-PublishStorageDeals"><a href="#25-PublishStorageDeals" class="headerlink" title="25.PublishStorageDeals"></a>25.PublishStorageDeals</h3><p>可用于获取订单信息：<br>接收方均为f05</p>
<h4 id="目的描述：-24"><a href="#目的描述：-24" class="headerlink" title="目的描述："></a>目的描述：</h4><p>发布一组新的存储交易（尚未包含在扇区中）</p>
<h4 id="官方代码注解：-9"><a href="#官方代码注解：-9" class="headerlink" title="官方代码注解："></a>官方代码注解：</h4><blockquote>
<p>// Publish a new set of storage deals (not yet included in a sector).<br>发布一组新的存储交易（尚未包含在扇区中）。</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">参数：</span><br><span class="line">		eg:		</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;Deals&quot;</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">&quot;Proposal&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;PieceCID&quot;</span>: <span class="string">&quot;baga6ea4seaqbbqcfwv7ucbv7eajwh2w553tchnicok7qwai4yu4c7b2apn6r2ma&quot;</span>,</span><br><span class="line">        <span class="string">&quot;PieceSize&quot;</span>: <span class="number">34359738368</span>,</span><br><span class="line">        <span class="string">&quot;VerifiedDeal&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="string">&quot;Client&quot;</span>: <span class="string">&quot;f1jttpq32myxfb3dt3ybytfyigvpltsjqssx427ai&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Provider&quot;</span>: <span class="string">&quot;f0228712&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Label&quot;</span>: <span class="string">&quot;mAXCg5AIgqJwIDcUlw/f92cpBgOq1kB3OjiRxXkE9Wp0NDMJBd04&quot;</span>,</span><br><span class="line">        <span class="string">&quot;StartEpoch&quot;</span>: <span class="number">737230</span>,</span><br><span class="line">        <span class="string">&quot;endEpoch&quot;</span>: <span class="number">2033862</span>,</span><br><span class="line">        <span class="string">&quot;StoragePricePerEpoch&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">        <span class="string">&quot;ProviderCollateral&quot;</span>: <span class="string">&quot;9039263001107346&quot;</span>,</span><br><span class="line">        <span class="string">&quot;ClientCollateral&quot;</span>: <span class="string">&quot;0&quot;</span></span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="string">&quot;ClientSignature&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;Type&quot;</span>: <span class="number">1</span>,</span><br><span class="line">        <span class="string">&quot;Signature&quot;</span>: <span class="string">&quot;OB7pmXMQXdQp0ZJGnld069S0tziGP/8Uas1YID6j6pkDsFwy5i1QHvb4E6d71JUys2LIT/KbzAiArhN/u4m7uQA=&quot;</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">&quot;Proposal&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;PieceCID&quot;</span>: <span class="string">&quot;baga6ea4seaqagafmbbtza2qwjutpejsjz3x7ebo7f3mrprtgrrxxttizixay2fq&quot;</span>,</span><br><span class="line">        <span class="string">&quot;PieceSize&quot;</span>: <span class="number">34359738368</span>,</span><br><span class="line">        <span class="string">&quot;VerifiedDeal&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="string">&quot;Client&quot;</span>: <span class="string">&quot;f1jttpq32myxfb3dt3ybytfyigvpltsjqssx427ai&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Provider&quot;</span>: <span class="string">&quot;f0228712&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Label&quot;</span>: <span class="string">&quot;mAXCg5AIgBlZudsHhXrh1X/X/2LiYvaP0vNHK7L7whZpr6CHVKUo&quot;</span>,</span><br><span class="line">        <span class="string">&quot;StartEpoch&quot;</span>: <span class="number">737230</span>,</span><br><span class="line">        <span class="string">&quot;endEpoch&quot;</span>: <span class="number">2033862</span>,</span><br><span class="line">        <span class="string">&quot;StoragePricePerEpoch&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">        <span class="string">&quot;ProviderCollateral&quot;</span>: <span class="string">&quot;9039263001107346&quot;</span>,</span><br><span class="line">        <span class="string">&quot;ClientCollateral&quot;</span>: <span class="string">&quot;0&quot;</span></span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="string">&quot;ClientSignature&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;Type&quot;</span>: <span class="number">1</span>,</span><br><span class="line">        <span class="string">&quot;Signature&quot;</span>: <span class="string">&quot;/swH/TYtX+83l059ghKjDv2DhygRJ0ZXqI8zTUS5k71x6p5R/SbNhl4Jx4gMvC6hO1JeoUZmW0GahUlqTnz/wwE=&quot;</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">&quot;Proposal&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;PieceCID&quot;</span>: <span class="string">&quot;baga6ea4seaqa4mo577aqlx4ryfjwfjwi2klsos2kginwu5eafnt5axuytbjjyjq&quot;</span>,</span><br><span class="line">        <span class="string">&quot;PieceSize&quot;</span>: <span class="number">34359738368</span>,</span><br><span class="line">        <span class="string">&quot;VerifiedDeal&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="string">&quot;Client&quot;</span>: <span class="string">&quot;f1jttpq32myxfb3dt3ybytfyigvpltsjqssx427ai&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Provider&quot;</span>: <span class="string">&quot;f0228712&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Label&quot;</span>: <span class="string">&quot;mAXCg5AIgOaXh/tq8OK1oqadZZL/F3tnYNm054yQaFoCCJJtllOk&quot;</span>,</span><br><span class="line">        <span class="string">&quot;StartEpoch&quot;</span>: <span class="number">737230</span>,</span><br><span class="line">        <span class="string">&quot;endEpoch&quot;</span>: <span class="number">2033862</span>,</span><br><span class="line">        <span class="string">&quot;StoragePricePerEpoch&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">        <span class="string">&quot;ProviderCollateral&quot;</span>: <span class="string">&quot;9039263001107346&quot;</span>,</span><br><span class="line">        <span class="string">&quot;ClientCollateral&quot;</span>: <span class="string">&quot;0&quot;</span></span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="string">&quot;ClientSignature&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;Type&quot;</span>: <span class="number">1</span>,</span><br><span class="line">        <span class="string">&quot;Signature&quot;</span>: <span class="string">&quot;MtTkzrjUpShs4XKGFKBk+SJihFFVQuAK5lni62ZmZR8Jucd6poY4ScRZfHRQHVj5gMGNEU5uS7/s09AvCAjtCwE=&quot;</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">返回值：</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;IDs&quot;</span>: [</span><br><span class="line">    <span class="number">1613103</span>,</span><br><span class="line">    <span class="number">1613104</span>,</span><br><span class="line">    <span class="number">1613105</span></span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>参数返回值解析</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> PublishStorageDealsParams <span class="keyword">struct</span> &#123;</span><br><span class="line">	Deals []ClientDealProposal</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> PublishStorageDealsReturn <span class="keyword">struct</span> &#123;</span><br><span class="line">	IDs []abi.DealID</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">type</span> ClientDealProposal <span class="keyword">struct</span> &#123;</span><br><span class="line">	Proposal        DealProposal</span><br><span class="line">	ClientSignature acrypto.Signature</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">type</span> DealProposal <span class="keyword">struct</span> &#123;</span><br><span class="line">	PieceCID     cid.Cid <span class="string">`checked:&quot;true&quot;`</span> <span class="comment">// Checked in validateDeal, CommP</span></span><br><span class="line">	PieceSize    abi.PaddedPieceSize</span><br><span class="line">	VerifiedDeal <span class="keyword">bool</span></span><br><span class="line">	Client       addr.Address</span><br><span class="line">	Provider     addr.Address</span><br><span class="line"></span><br><span class="line">	<span class="comment">// Label is an arbitrary client chosen label to apply to the deal</span></span><br><span class="line">	Label <span class="keyword">string</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// Nominal start epoch. Deal payment is linear between StartEpoch and EndEpoch,</span></span><br><span class="line">	<span class="comment">// with total amount StoragePricePerEpoch * (EndEpoch - StartEpoch).</span></span><br><span class="line">	<span class="comment">// Storage deal must appear in a sealed (proven) sector no later than StartEpoch,</span></span><br><span class="line">	<span class="comment">// otherwise it is invalid.</span></span><br><span class="line">	StartEpoch           abi.ChainEpoch</span><br><span class="line">	EndEpoch             abi.ChainEpoch</span><br><span class="line">	StoragePricePerEpoch abi.TokenAmount</span><br><span class="line"></span><br><span class="line">	ProviderCollateral abi.TokenAmount</span><br><span class="line">	ClientCollateral   abi.TokenAmount</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">type</span> Signature <span class="keyword">struct</span> &#123;</span><br><span class="line">	Type SigType</span><br><span class="line">	Data []<span class="keyword">byte</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">decodePublishStorageDeals</span><span class="params">(c context.Context, apii api.FullNode)</span></span> &#123;</span><br><span class="line">    decode, err := cid.Decode(<span class="string">&quot;bafy2bzacecf2mymfgzdfmi3xqmrwhsilpsp7oxp4xvxlrdxlq7i52sycgec3w&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="literal">nil</span> != err &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    messagea, err := apii.ChainGetMessage(c, decode)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    byHeight, err := apii.ChainGetTipSetByHeight(c, abi.ChainEpoch(<span class="number">5994432</span>), types.EmptyTSK)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    replay, err := apii.StateReplay(c, byHeight.Key(), messagea.Cid())</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> deal market.PublishStorageDealsParams</span><br><span class="line">    err = deal.UnmarshalCBOR(bytes.NewReader(messagea.Params))</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    err = deal.UnmarshalCBOR(bytes.NewReader(messagea.Params))</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    fmt.Println(deal.Deals[<span class="number">0</span>].ClientSignature,deal.Deals[<span class="number">0</span>].Proposal)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> dealReturn market.PublishStorageDealsReturn</span><br><span class="line">    err = dealReturn.UnmarshalCBOR(bytes.NewReader(replay.MsgRct.Return))</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    fmt.Println(dealReturn)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="26-RepayDebt"><a href="#26-RepayDebt" class="headerlink" title="26.RepayDebt"></a>26.RepayDebt</h3><h4 id="目的描述：-25"><a href="#目的描述：-25" class="headerlink" title="目的描述："></a>目的描述：</h4><p>偿还矿工的债务</p>
<p>假如发送方为A,接收方为B,f099为C，消息value为A转给B的转账金额，则有</p>
<blockquote>
<p>A=========&gt;B============&gt;C      (B转账给C初步推测是欠多少给多少)</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">参数：</span><br><span class="line">		eg:</span><br><span class="line">				</span><br><span class="line"></span><br><span class="line">无</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">返回值：</span><br><span class="line"></span><br><span class="line">无</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="27-ReportConsensusFault"><a href="#27-ReportConsensusFault" class="headerlink" title="27.ReportConsensusFault"></a>27.ReportConsensusFault</h3><h4 id="目的描述：-26"><a href="#目的描述：-26" class="headerlink" title="目的描述："></a>目的描述：</h4><p>报告共识错误：</p>
<p>假如发送方为A,接收方为B,f099为C，则有</p>
<blockquote>
<p>B===========&gt;C  (转出的金额占比大)</p>
<p>B============&gt;A</p>
</blockquote>
<h4 id="官方代码注解：-10"><a href="#官方代码注解：-10" class="headerlink" title="官方代码注解："></a>官方代码注解：</h4><blockquote>
<p>// Note: only the first reporter of any fault is rewarded.<br>   // Subsequent invocations fail because the target miner has been removed.<br>1.注意：只有任何故障的第一个报告者都将得到奖励。后续调用失败，因为已删除目标矿机。</p>
<p>// Elapsed since the fault (i.e. since the higher of the two blocks)<br>2.自故障以来经过的时间（即自两个块中的较高者起）</p>
<p>// Reward reporter with a share of the miner’s current balance.<br>3.用矿工当前余额的一部分奖励记者。</p>
<p>// Notify power actor with lock-up total being removed.<br>4.通知功率执行器，并移除锁定总量。</p>
<p>// close deals and burn funds<br>5.达成交易并消耗资金</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">参数：</span><br><span class="line">		eg:</span><br><span class="line">				</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;BlockHeader1&quot;</span>: <span class="string">&quot;kEQA7oUIgVhgk+tmEc6DFMKbveRDnHduz7k74iwe/OnLoT1TwdI8ioe0NbOhNe/q+ByU9jHbjl9JB7j+sl8pZpPey9S+XTo0PNHqqrtMIPjZyyysiepoQ9Y81WJ4JOS3tBVk5xZWHgksggFYYImsY7bvoxn9fCz0ooSS75YmGUL9AZg6s9vdpgkL7lyaDAgCZpd9eSNJe7ice3DDmwzYLk1XOSdwgGDaqtZrMPgXAwx73DKk09HFeZWnhAj29BCZipSD3HcQnNv3MiYvMYGCGgAKTSBYYKyuHtXzmQK65JMoYGDlJwnXr2zT/tPqeSVl0B4Pw5yU3soU428+iGMALXgkqtICwRjTACPfpaTHE1vfqB2ESag8bV/HugZQFrbIdrkX84fJMXcLRpwriSbzIBu80718loGCBFjAkCmIJEr1vhPQ7rskCFxWA2go4p+ip0mzWngRtABAssoS9zRwkr6T1wxj2KHpToZwlkna/9oNZbPFTQEXUdRWPrwy1733wENtfP5aBhLRJN6+mIYm1m2Fp2x8IsIy8qOVGI8xvumXu+74bQewqPtAcGy9xt89yYq2+fLeN4WWTCDUql4TlKf/AZ+rsgyPSFd4qNv4rSMDffBGDD0l+3AZ5o+ymCqjdXkvi44uq0JRCabu6tydPSUjbDGgs9kdvEqShdgqWCcAAXGg5AIgb3OXUK1wHCIM5ZxSq+oGujGA6AkDx84MG6+1jIfqki7YKlgnAAFxoOQCIKaLd2TP1w4A1sZF6vP4xiyxq6k/nHG65k03oscJzIyF2CpYJwABcaDkAiB54880YIWIKU4S9H1LriolQPkBgCaCpiiuLInNWr0SZtgqWCcAAXGg5AIghOFYoU6VMKLhF/7q3botODf6pO80kTWqshWMT3aRZW3YKlgnAAFxoOQCIKYMotY5aVf9IppugGnyBGbIAgR3YZiv8coF3wjwT4oPRgAC9rGiaBoACNa82CpYJwABcaDkAiDi+MoXeMV8v8S1sSUrstzzZAaNJiS/W7kApxb8+Qu/LNgqWCcAAXGg5AIgcaTKCXHNLZofK+1oowHeUlxIPYn1BYLOIeRLIc/xt3rYKlgnAAFxoOQCIKOSOPku5P7hSiIoZwK+B7PMFYcIGf2FzN7hOvESdqqAWGECl4SpcM+Vys4uNT+WdC+Rn1jSbiJFtE8GlfFl4M8x4UFXQP6LLKq50cJHmRaX5rveB7H3fKRAXCGW4VbjLb9uudQiQGN6D7iL6CZET91QZOJllT3M+VFKmK7+Zbz38BSeGmBNYmhYYQKG4YmV+ZBOy8jop1QbksjtfPOoYXr1N/t8dSUU0bnSyfDUfrZJifGW6AHV4QoMd7AEqsaye/IkscQvwFHUmRkT4Ow9my+p9o8s27KvlGVjyOzvONJPlEET/CAQFuv69XsARQBcAQrN&quot;</span>,</span><br><span class="line">  <span class="string">&quot;BlockHeader2&quot;</span>: <span class="string">&quot;kEQA7oUIgVhgk+tmEc6DFMKbveRDnHduz7k74iwe/OnLoT1TwdI8ioe0NbOhNe/q+ByU9jHbjl9JB7j+sl8pZpPey9S+XTo0PNHqqrtMIPjZyyysiepoQ9Y81WJ4JOS3tBVk5xZWHgksggFYYImsY7bvoxn9fCz0ooSS75YmGUL9AZg6s9vdpgkL7lyaDAgCZpd9eSNJe7ice3DDmwzYLk1XOSdwgGDaqtZrMPgXAwx73DKk09HFeZWnhAj29BCZipSD3HcQnNv3MiYvMYGCGgAKTSBYYKyuHtXzmQK65JMoYGDlJwnXr2zT/tPqeSVl0B4Pw5yU3soU428+iGMALXgkqtICwRjTACPfpaTHE1vfqB2ESag8bV/HugZQFrbIdrkX84fJMXcLRpwriSbzIBu80718loGCBFjAhr2sm/cgU/Sxg53wgTZ+IUc0meq4EYzSxArUbV9h3zpfHBPsWVugfaKCTny75fInr8mObyRKFbUbSIPmM9IKr/zMOaf1GDljvyYxxN3HEqbJbiew8s8CCegX5w+4UhofFNtusM13GDKhj2XHUmYDORZp2NAJmOGwoQlImFUoSABQSJqiLT2JcsiIGAuyRnRErUK3227pHtp5+eI7LOh8DCV/WTI26Jm368LZF6gmmfhAc5Bs0y9xWF38JQ1S5GxchdgqWCcAAXGg5AIgb3OXUK1wHCIM5ZxSq+oGujGA6AkDx84MG6+1jIfqki7YKlgnAAFxoOQCIKaLd2TP1w4A1sZF6vP4xiyxq6k/nHG65k03oscJzIyF2CpYJwABcaDkAiB54880YIWIKU4S9H1LriolQPkBgCaCpiiuLInNWr0SZtgqWCcAAXGg5AIghOFYoU6VMKLhF/7q3botODf6pO80kTWqshWMT3aRZW3YKlgnAAFxoOQCIKYMotY5aVf9IppugGnyBGbIAgR3YZiv8coF3wjwT4oPRgAC9rGiaBoACNa82CpYJwABcaDkAiDi+MoXeMV8v8S1sSUrstzzZAaNJiS/W7kApxb8+Qu/LNgqWCcAAXGg5AIgcaTKCXHNLZofK+1oowHeUlxIPYn1BYLOIeRLIc/xt3rYKlgnAAFxoOQCIINtGjb9VMSaZb5MEmHhjprkSQOpqT7sLXfXFhoFDEZOWGECkEzNSFTTvZdgsNKrXtKPee904kLafAEdlUDyF8h1oLHAjfbdNgh78DlAsUeVh2qKC3EPaHtMew2p+saY4pwDzV4mywYPadf1gVgU3oXMrTCXt30OPqrFfHUmoIV6wmX8GmBNYmhYYQKkZNggIPZpndPot4CT5BalL3Y9PYh6e3xH6zRnPVcgOLU0ZodkNAO0d98GDN/ys1EPObrlmKSsILk14UuWzUvcN5jG/ksu+lpP3l6LyyZhMaMtczFeS3Y13m/a6UxcUlsARQBcAQrN&quot;</span>,</span><br><span class="line">  <span class="string">&quot;BlockHeaderExtra&quot;</span>: <span class="string">&quot;&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">返回值：</span><br><span class="line"></span><br><span class="line">无</span><br></pre></td></tr></table></figure>

<p>参数解析</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> ReportConsensusFaultParams <span class="keyword">struct</span> &#123;</span><br><span class="line">	BlockHeader1     []<span class="keyword">byte</span></span><br><span class="line">	BlockHeader2     []<span class="keyword">byte</span></span><br><span class="line">	BlockHeaderExtra []<span class="keyword">byte</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">decodeReportConsensusFault</span><span class="params">(c context.Context, apii api.FullNode)</span></span> &#123;</span><br><span class="line">    decode, err := cid.Decode(<span class="string">&quot;bafy2bzacedasxczbtp73yunldbfia4wfn5qjzaw2mgqair36abpwdhpflmaf2&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    message, err := apii.ChainGetMessage(c, decode)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> cc minerr.ReportConsensusFaultParams</span><br><span class="line">    err = cc.UnmarshalCBOR(bytes.NewReader(message.Params))</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    fmt.Println(cc)</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="28-Send"><a href="#28-Send" class="headerlink" title="28.Send"></a>28.Send</h3><h4 id="目的描述：-27"><a href="#目的描述：-27" class="headerlink" title="目的描述："></a>目的描述：</h4><p>用于转账，消息value值即为转账金额，一般创建普通用户的时间与第一次往该账户转账的消息时间相同</p>
<p>普通转账，将金额 <em>Value</em> 从 <em>From</em> 转移到 <em>To</em>。</p>
<h4 id="调用参数-8"><a href="#调用参数-8" class="headerlink" title="调用参数"></a>调用参数</h4><p>任意字节串</p>
<h4 id="返回值-8"><a href="#返回值-8" class="headerlink" title="返回值"></a>返回值</h4><p>无</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">参数：</span><br><span class="line">		eg:</span><br><span class="line">无</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">返回值：</span><br><span class="line"></span><br><span class="line">无</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="29-Settle"><a href="#29-Settle" class="headerlink" title="29.Settle"></a>29.Settle</h3><p>接收方均为支付通道</p>
<h4 id="目的描述：-28"><a href="#目的描述：-28" class="headerlink" title="目的描述："></a>目的描述：</h4><p>结清</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">参数：</span><br><span class="line">		eg:</span><br><span class="line">无</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">返回值：</span><br><span class="line"></span><br><span class="line">无</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="30-SubmitWindowedPoSt"><a href="#30-SubmitWindowedPoSt" class="headerlink" title="30.SubmitWindowedPoSt"></a>30.SubmitWindowedPoSt</h3><h4 id="目的描述：-29"><a href="#目的描述：-29" class="headerlink" title="目的描述："></a>目的描述：</h4><p>矿工提交抽查信息。提交时空证明</p>
<h4 id="调用参数-9"><a href="#调用参数-9" class="headerlink" title="调用参数"></a>调用参数</h4><p> <em>Deadline</em> <em>Partitions</em> <em>Proofs</em> <em>ChainCommitEpoch</em> <em>ChainCommitRand</em></p>
<h4 id="返回值-9"><a href="#返回值-9" class="headerlink" title="返回值"></a>返回值</h4><p>无 </p>
<h4 id="官方代码注解：-11"><a href="#官方代码注解：-11" class="headerlink" title="官方代码注解："></a>官方代码注解：</h4><blockquote>
<p>Invoked by miner’s worker address to submit their fallback post</p>
<p>由矿工的工作地址调用以提交其fallback post</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">参数：</span><br><span class="line">		eg:</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;Deadline&quot;</span>: <span class="number">1</span>,</span><br><span class="line">  <span class="string">&quot;Partitions&quot;</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">&quot;Index&quot;</span>: <span class="number">0</span>,</span><br><span class="line">      <span class="string">&quot;Skipped&quot;</span>: <span class="string">&quot;&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  <span class="string">&quot;Proofs&quot;</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">&quot;PoStProof&quot;</span>: <span class="number">8</span>,</span><br><span class="line">      <span class="string">&quot;ProofBytes&quot;</span>: <span class="string">&quot;oWLjMjrTGC0Lr+2YEgbI5hWZDm2QNa2SHU0fb2uE9K4HkxllfihiHw4SNX4d5aN2gKZblKm8VdYLZh5R9bw9vHFQXUtF5909zict6vtMwg2RLmhVONmjwrYVAy+DzuxVDiiHsi57Q/Sx/FTZ7BqOnZf1KmKREv9c+mL/qWurFWRHgWez5o+TonjdehHmNhposTQxTSOpFeeAYBOWfhid2FTQ7Db16rKLrjliXfXJISOTC1nBBpkyTGJjGb6jE9r7&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  <span class="string">&quot;ChainCommitEpoch&quot;</span>: <span class="number">593732</span>,</span><br><span class="line">  <span class="string">&quot;ChainCommitRand&quot;</span>: <span class="string">&quot;EGJbvn3HjjoMkkIJtTvtlu4Exm5PxJUgq7cOP/58IG0=&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">返回值：</span><br><span class="line"></span><br><span class="line">无</span><br></pre></td></tr></table></figure>

<p>参数解析</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> SubmitWindowedPoStParams <span class="keyword">struct</span> &#123;</span><br><span class="line">	<span class="comment">// The deadline index which the submission targets.</span></span><br><span class="line">	Deadline <span class="keyword">uint64</span></span><br><span class="line">	<span class="comment">// The partitions being proven.</span></span><br><span class="line">	Partitions []PoStPartition</span><br><span class="line">	<span class="comment">// Array of proofs, one per distinct registered proof type present in the sectors being proven.</span></span><br><span class="line">	<span class="comment">// In the usual case of a single proof type, this array will always have a single element (independent of number of partitions).</span></span><br><span class="line">	Proofs []proof.PoStProof</span><br><span class="line">	<span class="comment">// The epoch at which these proofs is being committed to a particular chain.</span></span><br><span class="line">	ChainCommitEpoch abi.ChainEpoch</span><br><span class="line">	<span class="comment">// The ticket randomness on the chain at the ChainCommitEpoch on the chain this post is committed to</span></span><br><span class="line">	ChainCommitRand abi.Randomness</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">type</span> PoStPartition <span class="keyword">struct</span> &#123;</span><br><span class="line">	<span class="comment">// Partitions are numbered per-deadline, from zero.</span></span><br><span class="line">	Index <span class="keyword">uint64</span></span><br><span class="line">	<span class="comment">// Sectors skipped while proving that weren&#x27;t already declared faulty</span></span><br><span class="line">	Skipped bitfield.BitField</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">type</span> PoStProof <span class="keyword">struct</span> &#123;</span><br><span class="line">	PoStProof  abi.RegisteredPoStProof</span><br><span class="line">	ProofBytes []<span class="keyword">byte</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">decodeSubmitWindowedPoSt</span><span class="params">(c context.Context, apii api.FullNode)</span></span> &#123;</span><br><span class="line">    decode, err := cid.Decode(<span class="string">&quot;bafy2bzaceasif5qkctme4sa6crafmdogmgncggzuous5dzrl3exbbtremcjsy&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    message, err := apii.ChainGetMessage(c, decode)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> cc minerr.SubmitWindowedPoStParams</span><br><span class="line">    err = cc.UnmarshalCBOR(bytes.NewReader(message.Params))</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    fmt.Println(cc)</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="31-SwapSigner"><a href="#31-SwapSigner" class="headerlink" title="31.SwapSigner"></a>31.SwapSigner</h3><h4 id="目的描述：-30"><a href="#目的描述：-30" class="headerlink" title="目的描述："></a>目的描述：</h4><p>交换签名者</p>
<p>目前此类信息都报了错，错误信息例如：</p>
<blockquote>
<p>caller f09524 is not one of [f020286] (RetCode=8)               SysErrForbidden</p>
</blockquote>
<h4 id="官方代码注解：-12"><a href="#官方代码注解：-12" class="headerlink" title="官方代码注解："></a>官方代码注解：</h4><blockquote>
<p>// Can only be called by the multisig wallet itself.</p>
<p>//只能由multisig钱包本身调用。</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">参数：</span><br><span class="line">		eg:</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;From&quot;</span>: <span class="string">&quot;f137sjdbgunloi7couiy4l5nc7pd6k2jmq32vizpy&quot;</span>,</span><br><span class="line">  <span class="string">&quot;To&quot;</span>: <span class="string">&quot;f1mkbuonewc5htwyodaoy3bhxgxo6o2oetdmr4uwq&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">返回值：</span><br><span class="line"></span><br><span class="line">无</span><br></pre></td></tr></table></figure>

<p>参数解析</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> SwapSignerParams <span class="keyword">struct</span> &#123;</span><br><span class="line">	From addr.Address</span><br><span class="line">	To   addr.Address</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">decodeSwapSigner</span><span class="params">(c context.Context, apii api.FullNode)</span></span> &#123;</span><br><span class="line">    decode, err := cid.Decode(<span class="string">&quot;bafy2bzaceas4ivprqbveyoua24sedjpzeamri3refwvskoibovto5gxb55kwg&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    message, err := apii.ChainGetMessage(c, decode)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> cc multisig.SwapSignerParams</span><br><span class="line">    err = cc.UnmarshalCBOR(bytes.NewReader(message.Params))</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    fmt.Println(cc)</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="32-TerminateSectors"><a href="#32-TerminateSectors" class="headerlink" title="32.TerminateSectors"></a>32.TerminateSectors</h3><p>此处消息接收方会转账给f099</p>
<h4 id="目的描述：-31"><a href="#目的描述：-31" class="headerlink" title="目的描述："></a>目的描述：</h4><p>终止交易和扇区</p>
<h4 id="官方代码注解：-13"><a href="#官方代码注解：-13" class="headerlink" title="官方代码注解："></a>官方代码注解：</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Marks some sectors as terminated at the present epoch, earlier than their</span></span><br><span class="line"><span class="comment">// scheduled termination, and adds these sectors to the early termination queue.</span></span><br><span class="line"><span class="comment">// This method then processes up to AddressedSectorsMax sectors and</span></span><br><span class="line"><span class="comment">// AddressedPartitionsMax partitions from the early termination queue,</span></span><br><span class="line"><span class="comment">// terminating deals, paying fines, and returning pledge collateral. While</span></span><br><span class="line"><span class="comment">// sectors remain in this queue:</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  1. The miner will be unable to withdraw funds.</span></span><br><span class="line"><span class="comment">//  2. The chain will process up to AddressedSectorsMax sectors and</span></span><br><span class="line"><span class="comment">//     AddressedPartitionsMax per epoch until the queue is empty.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// The sectors are immediately ignored for Window PoSt proofs, and should be</span></span><br><span class="line"><span class="comment">// masked in the same way as faulty sectors. A miner terminating sectors in the</span></span><br><span class="line"><span class="comment">// current deadline must be careful to compute an appropriate Window PoSt proof</span></span><br><span class="line"><span class="comment">// for the sectors that will be active at the time the PoSt is submitted.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// This function may be invoked with no new sectors to explicitly process the</span></span><br><span class="line"><span class="comment">// next batch of sectors.</span></span><br><span class="line"></span><br><span class="line">将某些扇区标记为在当前时期终止，早于它们</span><br><span class="line"><span class="comment">//计划终止，并将这些扇区添加到早期终止队列中。</span></span><br><span class="line"><span class="comment">//然后此方法最多处理AddressedSectorsMax个扇区，</span></span><br><span class="line"><span class="comment">//提早终止队列中的AddressedPartitionsMax分区，</span></span><br><span class="line"><span class="comment">//终止交易，支付罚款并退还抵押物。尽管</span></span><br><span class="line"><span class="comment">//扇区保留在此队列中:</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="number">1.</span>矿工将无法提取资金。</span><br><span class="line"><span class="number">2.</span>链将处理多达AddressedSectorsMax个扇区，</span><br><span class="line"><span class="comment">//每个时期的AddressedPartitionsMax，直到队列为空。</span></span><br><span class="line"></span><br><span class="line">对于Window PoSt证明，将立即忽略该扇区，并且应将其设置为</span><br><span class="line"><span class="comment">//以与故障扇区相同的方式进行屏蔽。一个矿工终止了</span></span><br><span class="line"><span class="comment">//当前的截止日期必须谨慎以计算适当的Window PoSt证明</span></span><br><span class="line"><span class="comment">//对于在提交PoSt时将处于活动状态的扇区。</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">可以在没有新扇区的情况下调用此函数来显式处理</span><br><span class="line"><span class="comment">//下一批扇区。</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">参数：</span><br><span class="line">		eg:</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;Terminations&quot;</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">&quot;Deadline&quot;</span>: <span class="number">11</span>,</span><br><span class="line">      <span class="string">&quot;Partition&quot;</span>: <span class="number">0</span>,</span><br><span class="line">      <span class="string">&quot;Sectors&quot;</span>: <span class="string">&quot;30950,31197&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">返回值：</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;Done&quot;</span>: <span class="literal">true</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>参数返回值解析</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> TerminateSectorsParams <span class="keyword">struct</span> &#123;</span><br><span class="line">	Terminations []TerminationDeclaration</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> TerminationDeclaration <span class="keyword">struct</span> &#123;</span><br><span class="line">	Deadline  <span class="keyword">uint64</span></span><br><span class="line">	Partition <span class="keyword">uint64</span></span><br><span class="line">	Sectors   bitfield.BitField</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> TerminateSectorsReturn <span class="keyword">struct</span> &#123;</span><br><span class="line">	<span class="comment">// Set to true if all early termination work has been completed. When</span></span><br><span class="line">	<span class="comment">// false, the miner may choose to repeatedly invoke TerminateSectors</span></span><br><span class="line">	<span class="comment">// with no new sectors to process the remainder of the pending</span></span><br><span class="line">	<span class="comment">// terminations. While pending terminations are outstanding, the miner</span></span><br><span class="line">	<span class="comment">// will not be able to withdraw funds.</span></span><br><span class="line">	Done <span class="keyword">bool</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">decodeTerminateSectors</span><span class="params">(c context.Context, apii api.FullNode)</span></span> &#123;</span><br><span class="line">    decode, err := cid.Decode(<span class="string">&quot;bafy2bzacea2vi7x7dnxy2dn3f6jkhj7itjltofkqittuqhcjkvbzylijpiof4&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    message, err := apii.ChainGetMessage(c, decode)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> cc minerr.TerminateSectorsParams</span><br><span class="line">    err = cc.UnmarshalCBOR(bytes.NewReader(message.Params))</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    fmt.Println(cc)</span><br><span class="line">    tipset, err := apii.ChainGetTipSetByHeight(c, abi.ChainEpoch(<span class="number">594247</span>), types.EmptyTSK)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    replay, err := apii.StateReplay(c, tipset.Key(), decode)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> aa minerr.TerminateSectorsReturn</span><br><span class="line">    err = aa.UnmarshalCBOR(bytes.NewBuffer(replay.MsgRct.Return))</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    fmt.Println(aa)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="33-UpdateChannelState"><a href="#33-UpdateChannelState" class="headerlink" title="33.UpdateChannelState"></a>33.UpdateChannelState</h3><h4 id="目的描述：-32"><a href="#目的描述：-32" class="headerlink" title="目的描述："></a>目的描述：</h4><p>更新支付通道状态</p>
<h4 id="官方代码注释：-2"><a href="#官方代码注释：-2" class="headerlink" title="官方代码注释："></a>官方代码注释：</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// both parties must sign voucher: one who submits it, the other explicitly signs it</span></span><br><span class="line">双方必须签署凭证：一个人提交凭证，另一方明确签署凭证</span><br><span class="line"></span><br><span class="line"><span class="comment">// Find the voucher lane, creating if necessary.</span></span><br><span class="line">找到凭证通道，必要时创建。</span><br><span class="line"></span><br><span class="line"><span class="comment">// The next section actually calculates the payment amounts to update the payment channel state</span></span><br><span class="line">下一部分实际计算付款金额以更新付款渠道状态/</span><br><span class="line"></span><br><span class="line"><span class="comment">// 1. (optional) sum already redeemed value of all merging lanes</span></span><br><span class="line"><span class="comment">// 1.（可选）所有合并通道的已赎回值总和</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. To prevent double counting, remove already redeemed amounts (from voucher or other lanes) from the voucher amount</span></span><br><span class="line"><span class="comment">// 2.为防止重复计算，请从中删除已兑换的金额（从优惠券/凭证金额中的//优惠券/凭证或其他通道）</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 3. set new redeemed value for merged-into lane</span></span><br><span class="line"><span class="comment">// 3.为合并入车道设置新的赎回值</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 4. check operation validity</span></span><br><span class="line"><span class="comment">// 4.检查操作有效性</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 5. add new redemption ToSend</span></span><br><span class="line"><span class="comment">// 5.添加新的兑换ToSend</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// update channel settlingAt and MinSettleHeight if delayed by voucher</span></span><br><span class="line">如果凭证延迟，则更新频道settlingAt和MinSettleHeight</span><br></pre></td></tr></table></figure>



<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">参数：</span><br><span class="line">		eg:</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;Sv&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;ChannelAddr&quot;</span>: <span class="string">&quot;f2eyy7thzvqkryhhtieacpy7eghm3w7yogtdr7a7q&quot;</span>,</span><br><span class="line">    <span class="string">&quot;TimeLockMin&quot;</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="string">&quot;TimeLockMax&quot;</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="string">&quot;SecretPreimage&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Extra&quot;</span>: null,</span><br><span class="line">    <span class="string">&quot;Lane&quot;</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="string">&quot;Nonce&quot;</span>: <span class="number">10</span>,</span><br><span class="line">    <span class="string">&quot;Amount&quot;</span>: <span class="string">&quot;115396630&quot;</span>,</span><br><span class="line">    <span class="string">&quot;MinSettleHeight&quot;</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="string">&quot;Merges&quot;</span>: [],</span><br><span class="line">    <span class="string">&quot;Signature&quot;</span>: &#123;</span><br><span class="line">      <span class="string">&quot;Type&quot;</span>: <span class="number">2</span>,</span><br><span class="line">      <span class="string">&quot;Signature&quot;</span>: <span class="string">&quot;kc8Q1poJSz+7pQQUiEU4LQX2B8HO1jhWBRBE+nHaeEcFr6G1ZBiwh3ivQ0HHBU4iE9tMUQZAmuGtOOIDBIntnDJonxPlY+Q5wakC+E70B7R30lssSdhMAcCyvWP0NkLy&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">&quot;Secret&quot;</span>: <span class="string">&quot;&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">返回值：</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>参数解析</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> UpdateChannelStateParams <span class="keyword">struct</span> &#123;</span><br><span class="line">	Sv     SignedVoucher</span><br><span class="line">	Secret []<span class="keyword">byte</span></span><br><span class="line">&#125;<span class="comment">//需注意，有不同的版本，调错包会解析错误</span></span><br><span class="line"><span class="comment">// A voucher is sent by `From` to `To` off-chain in order to enable</span></span><br><span class="line"><span class="comment">// `To` to redeem payments on-chain in the future</span></span><br><span class="line"><span class="keyword">type</span> SignedVoucher <span class="keyword">struct</span> &#123;</span><br><span class="line">	<span class="comment">// ChannelAddr is the address of the payment channel this signed voucher is valid for</span></span><br><span class="line">	ChannelAddr addr.Address</span><br><span class="line">	<span class="comment">// TimeLockMin sets a min epoch before which the voucher cannot be redeemed</span></span><br><span class="line">	TimeLockMin abi.ChainEpoch</span><br><span class="line">	<span class="comment">// TimeLockMax sets a max epoch beyond which the voucher cannot be redeemed</span></span><br><span class="line">	<span class="comment">// TimeLockMax set to 0 means no timeout</span></span><br><span class="line">	TimeLockMax abi.ChainEpoch</span><br><span class="line">	<span class="comment">// (optional) The SecretPreImage is used by `To` to validate</span></span><br><span class="line">	SecretPreimage []<span class="keyword">byte</span></span><br><span class="line">	<span class="comment">// (optional) Extra can be specified by `From` to add a verification method to the voucher</span></span><br><span class="line">	Extra *ModVerifyParams</span><br><span class="line">	<span class="comment">// Specifies which lane the Voucher merges into (will be created if does not exist)</span></span><br><span class="line">	Lane <span class="keyword">uint64</span></span><br><span class="line">	<span class="comment">// Nonce is set by `From` to prevent redemption of stale vouchers on a lane</span></span><br><span class="line">	Nonce <span class="keyword">uint64</span></span><br><span class="line">	<span class="comment">// Amount voucher can be redeemed for</span></span><br><span class="line">	Amount big.Int</span><br><span class="line">	<span class="comment">// (optional) MinSettleHeight can extend channel MinSettleHeight if needed</span></span><br><span class="line">	MinSettleHeight abi.ChainEpoch</span><br><span class="line"></span><br><span class="line">	<span class="comment">// (optional) Set of lanes to be merged into `Lane`</span></span><br><span class="line">	Merges []Merge</span><br><span class="line"></span><br><span class="line">	<span class="comment">// Sender&#x27;s signature over the voucher</span></span><br><span class="line">	Signature *crypto.Signature</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Modular Verification method</span></span><br><span class="line"><span class="keyword">type</span> ModVerifyParams <span class="keyword">struct</span> &#123;</span><br><span class="line">	Actor  addr.Address</span><br><span class="line">	Method abi.MethodNum</span><br><span class="line">	Data   []<span class="keyword">byte</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">type</span> Merge <span class="keyword">struct</span> &#123;</span><br><span class="line">	Lane  <span class="keyword">uint64</span></span><br><span class="line">	Nonce <span class="keyword">uint64</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">type</span> Signature <span class="keyword">struct</span> &#123;</span><br><span class="line">	Type SigType</span><br><span class="line">	Data []<span class="keyword">byte</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">decodeUpdateChannelState</span><span class="params">(c context.Context, apii api.FullNode)</span></span> &#123;</span><br><span class="line">    decode, err := cid.Decode(<span class="string">&quot;bafy2bzacebotu3436hjgtzka32qtqusq7jhyx3vpbfsg3iq7vyjkmxdgh3fjg&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    message, err := apii.ChainGetMessage(c, decode)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    tipSet, err := apii.ChainGetTipSetByHeight(c, abi.ChainEpoch(<span class="number">414829</span>), types.EmptyTSK)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    params, err := apii.StateDecodeParams(c, message.To, message.Method, message.Params, tipSet.Key())</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    fmt.Println(params)</span><br><span class="line">    <span class="keyword">var</span> cc paych.UpdateChannelStateParams</span><br><span class="line">    err = cc.UnmarshalCBOR(bytes.NewReader(message.Params))</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    fmt.Println(cc)</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<hr>
<h3 id="34-WithdrawBalance-market"><a href="#34-WithdrawBalance-market" class="headerlink" title="34.WithdrawBalance (market)"></a>34.WithdrawBalance (market)</h3><p>提款余额（市场）：<br>消息接收方为f05，此类消息用于取出余额，由f05给消息发送方转账，转账金额为消息参数中的Amount值，Address为消息发送方</p>
<h4 id="目的描述：-33"><a href="#目的描述：-33" class="headerlink" title="目的描述："></a>目的描述：</h4><p>尝试从托管的余额中提取指定的金额。 如果少于指定的可用数量，则产生全部可用余额。</p>
<h4 id="官方代码注解：-14"><a href="#官方代码注解：-14" class="headerlink" title="官方代码注解："></a>官方代码注解：</h4><blockquote>
<p>// Attempt to withdraw the specified amount from the balance held in escrow.<br>// If less than the specified amount is available, yields the entire available balance.</p>
<p>尝试从托管的余额中提取指定的金额。 如果少于指定的可用数量，则产生全部可用余额。</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">参数：</span><br><span class="line">		eg:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;Address&quot;</span>: <span class="string">&quot;f3u4vfats72x236ylbnhxgajit2cyliq7ehwe7b2x42ayfwlwyohoaeym6gm6cwlx2df5z5jripvftaiwm5ila&quot;</span>,</span><br><span class="line">  <span class="string">&quot;Amount&quot;</span>: <span class="string">&quot;90000000000000000000&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">返回值：</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>参数解析</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> WithdrawBalanceParams <span class="keyword">struct</span> &#123;</span><br><span class="line">	ProviderOrClientAddress addr.Address</span><br><span class="line">	Amount                  abi.TokenAmount</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">decodeWithdrawBalancemarket</span><span class="params">(c context.Context, apii api.FullNode)</span></span> &#123;</span><br><span class="line">    decode, err := cid.Decode(<span class="string">&quot;bafy2bzaceduitn67vyfij75nzpmy4k4m7qk3tlsutuzzjt5thyzxeeox6rzzg&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    message, err := apii.ChainGetMessage(c, decode)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> cc market.WithdrawBalanceParams</span><br><span class="line">    err = cc.UnmarshalCBOR(bytes.NewReader(message.Params))</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    fmt.Println(cc)</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="35-WithdrawBalance-miner"><a href="#35-WithdrawBalance-miner" class="headerlink" title="35.WithdrawBalance (miner)"></a>35.WithdrawBalance (miner)</h3><p>提款余额（矿工）：<br>消息接收方为矿工，此类消息用于取出余额，由矿工给消息发送方转账，转账金额为消息参数中的AmountRequested值。</p>
<h4 id="目的描述：-34"><a href="#目的描述：-34" class="headerlink" title="目的描述："></a>目的描述：</h4><p>将矿工地址内的余额提取至 Owner 地址，提取的金额为 <em>AmountRequested</em> 与 <em>AvailableBalance</em> 的较小值，具体金额可在 <em>InternalExecutions</em> 中获取。</p>
<h4 id="调用参数-10"><a href="#调用参数-10" class="headerlink" title="调用参数"></a>调用参数</h4><p> <em>AmountRequested</em> 希望提取的金额。</p>
<h4 id="返回值-10"><a href="#返回值-10" class="headerlink" title="返回值"></a>返回值</h4><p>无</p>
<h4 id="官方代码注解：-15"><a href="#官方代码注解：-15" class="headerlink" title="官方代码注解："></a>官方代码注解：</h4><blockquote>
<p>1.由于拥有者属于/受其控制，因此仅所有者可以提取余额，而不是work。<br>2.确保我们没有任何未决的终止。<br>3.释放既有资金，以便我们可以花费它们。<br>4.验证InitialPledgeRequirement是否不超过解锁资金</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">参数：</span><br><span class="line">		eg:</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;AmountRequested&quot;</span>: <span class="string">&quot;111000000000000000000&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">返回值：</span><br></pre></td></tr></table></figure>

<p>参数解析</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> WithdrawBalanceParams <span class="keyword">struct</span> &#123;</span><br><span class="line">	AmountRequested abi.TokenAmount</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">decodeWithdrawBalanceminer</span><span class="params">(c context.Context, apii api.FullNode)</span></span> &#123;</span><br><span class="line">    decode, err := cid.Decode(<span class="string">&quot;bafy2bzaceb25aj2vqqfvhfy3zj5umcorznp7ggi3fud34g4ipvqshnqnem6zi&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    message, err := apii.ChainGetMessage(c, decode)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> cc minerr.WithdrawBalanceParams</span><br><span class="line">    err = cc.UnmarshalCBOR(bytes.NewReader(message.Params))</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">    fmt.Println(cc)</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">Akesu</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="http://example.com/%E6%B6%88%E6%81%AF%E5%88%9D%E6%AD%A5%E5%88%86%E6%9E%90/">http://example.com/%E6%B6%88%E6%81%AF%E5%88%9D%E6%AD%A5%E5%88%86%E6%9E%90/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="next-post pull-full"><a href="/%E7%9F%BF%E5%B7%A5%E5%92%8C%E7%94%A8%E6%88%B7%E6%80%8E%E6%A0%B7%E5%90%88%E4%BD%9C%E5%85%B1%E8%B5%A2/"><img class="next-cover" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">矿工和用户怎样合作共赢</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-info-avatar is-center"><img class="avatar-img" src="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-info__name">Akesu</div><div class="author-info__description"></div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">10</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>Announcement</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Catalog</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-AddBalance"><span class="toc-number">1.</span> <span class="toc-text">1.AddBalance</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%AE%E7%9A%84%E6%8F%8F%E8%BF%B0%EF%BC%9A"><span class="toc-number">1.1.</span> <span class="toc-text">目的描述：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%98%E6%96%B9%E4%BB%A3%E7%A0%81%E6%B3%A8%E8%A7%A3"><span class="toc-number">1.2.</span> <span class="toc-text">官方代码注解</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-AddLockedFund"><span class="toc-number">2.</span> <span class="toc-text">2.AddLockedFund</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%AE%E7%9A%84%E6%8F%8F%E8%BF%B0%EF%BC%9A-1"><span class="toc-number">2.1.</span> <span class="toc-text">目的描述：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%98%E6%96%B9%E4%BB%A3%E7%A0%81%E6%B3%A8%E8%A7%A3%EF%BC%9A"><span class="toc-number">2.2.</span> <span class="toc-text">官方代码注解：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-AddVerifiedClient"><span class="toc-number">3.</span> <span class="toc-text">3.AddVerifiedClient</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%AE%E7%9A%84%E6%8F%8F%E8%BF%B0%EF%BC%9A-2"><span class="toc-number">3.1.</span> <span class="toc-text">目的描述：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%98%E6%96%B9%E4%BB%A3%E7%A0%81%E6%B3%A8%E8%A7%A3%EF%BC%9A-1"><span class="toc-number">3.2.</span> <span class="toc-text">官方代码注解：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-Approve"><span class="toc-number">4.</span> <span class="toc-text">4.Approve</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%AE%E7%9A%84%E6%8F%8F%E8%BF%B0%EF%BC%9A-3"><span class="toc-number">4.1.</span> <span class="toc-text">目的描述：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%98%E6%96%B9%E4%BB%A3%E7%A0%81%E6%B3%A8%E8%A7%A3%EF%BC%9A-2"><span class="toc-number">4.2.</span> <span class="toc-text">官方代码注解：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-Cancel"><span class="toc-number">5.</span> <span class="toc-text">5.Cancel</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%AE%E7%9A%84%E6%8F%8F%E8%BF%B0%EF%BC%9A-4"><span class="toc-number">5.1.</span> <span class="toc-text">目的描述：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-ChangeMultiaddrs"><span class="toc-number">6.</span> <span class="toc-text">6.ChangeMultiaddrs</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%AE%E7%9A%84%E6%8F%8F%E8%BF%B0%EF%BC%9A-5"><span class="toc-number">6.1.</span> <span class="toc-text">目的描述：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%B0%83%E7%94%A8%E5%8F%82%E6%95%B0"><span class="toc-number">6.2.</span> <span class="toc-text">调用参数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BF%94%E5%9B%9E%E5%80%BC"><span class="toc-number">6.3.</span> <span class="toc-text">返回值</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-ChangeOwnerAddress"><span class="toc-number">7.</span> <span class="toc-text">7.ChangeOwnerAddress</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%AE%E7%9A%84%E6%8F%8F%E8%BF%B0%EF%BC%9A-6"><span class="toc-number">7.1.</span> <span class="toc-text">目的描述：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-ChangePeerID"><span class="toc-number">8.</span> <span class="toc-text">8.ChangePeerID</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%AE%E7%9A%84%E6%8F%8F%E8%BF%B0%EF%BC%9A-7"><span class="toc-number">8.1.</span> <span class="toc-text">目的描述：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%B0%83%E7%94%A8%E5%8F%82%E6%95%B0-1"><span class="toc-number">8.2.</span> <span class="toc-text">调用参数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BF%94%E5%9B%9E%E5%80%BC-1"><span class="toc-number">8.3.</span> <span class="toc-text">返回值</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-ChangeWorkerAddress"><span class="toc-number">9.</span> <span class="toc-text">9.ChangeWorkerAddress</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%AE%E7%9A%84%E6%8F%8F%E8%BF%B0%EF%BC%9A-8"><span class="toc-number">9.1.</span> <span class="toc-text">目的描述：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%B0%83%E7%94%A8%E5%8F%82%E6%95%B0-2"><span class="toc-number">9.2.</span> <span class="toc-text">调用参数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BF%94%E5%9B%9E%E5%80%BC-2"><span class="toc-number">9.3.</span> <span class="toc-text">返回值</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%98%E6%96%B9%E4%BB%A3%E7%A0%81%E6%B3%A8%E8%A7%A3%EF%BC%9A-3"><span class="toc-number">9.4.</span> <span class="toc-text">官方代码注解：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-Collect"><span class="toc-number">10.</span> <span class="toc-text">10.Collect</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%AE%E7%9A%84%E6%8F%8F%E8%BF%B0%EF%BC%9A-9"><span class="toc-number">10.1.</span> <span class="toc-text">目的描述：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11-CompactSectorNumbers"><span class="toc-number">11.</span> <span class="toc-text">11.CompactSectorNumbers</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%AE%E7%9A%84%E6%8F%8F%E8%BF%B0%EF%BC%9A-10"><span class="toc-number">11.1.</span> <span class="toc-text">目的描述：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%98%E6%96%B9%E4%BB%A3%E7%A0%81%E6%B3%A8%E8%A7%A3%EF%BC%9A-4"><span class="toc-number">11.2.</span> <span class="toc-text">官方代码注解：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12-ConfirmUpdateWorkerKey"><span class="toc-number">12.</span> <span class="toc-text">12.ConfirmUpdateWorkerKey</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%AE%E7%9A%84%E6%8F%8F%E8%BF%B0%EF%BC%9A-11"><span class="toc-number">12.1.</span> <span class="toc-text">目的描述：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13-Constructor"><span class="toc-number">13.</span> <span class="toc-text">13.Constructor</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%AE%E7%9A%84%E6%8F%8F%E8%BF%B0%EF%BC%9A-12"><span class="toc-number">13.1.</span> <span class="toc-text">目的描述：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%98%E6%96%B9%E4%BB%A3%E7%A0%81%E6%B3%A8%E8%A7%A3%EF%BC%9A-5"><span class="toc-number">13.2.</span> <span class="toc-text">官方代码注解：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#14-ControlAddresses"><span class="toc-number">14.</span> <span class="toc-text">14.ControlAddresses</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%AE%E7%9A%84%E6%8F%8F%E8%BF%B0%EF%BC%9A-13"><span class="toc-number">14.1.</span> <span class="toc-text">目的描述：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%B0%83%E7%94%A8%E5%8F%82%E6%95%B0-3"><span class="toc-number">14.2.</span> <span class="toc-text">调用参数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BF%94%E5%9B%9E%E5%80%BC-3"><span class="toc-number">14.3.</span> <span class="toc-text">返回值</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#15-CreateMiner"><span class="toc-number">15.</span> <span class="toc-text">15.CreateMiner</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%AE%E7%9A%84%E6%8F%8F%E8%BF%B0%EF%BC%9A-14"><span class="toc-number">15.1.</span> <span class="toc-text">目的描述：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%B0%83%E7%94%A8%E5%8F%82%E6%95%B0-4"><span class="toc-number">15.2.</span> <span class="toc-text">调用参数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BF%94%E5%9B%9E%E5%80%BC-4"><span class="toc-number">15.3.</span> <span class="toc-text">返回值</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#16-DeclareFaults"><span class="toc-number">16.</span> <span class="toc-text">16.DeclareFaults</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%AE%E7%9A%84%E6%8F%8F%E8%BF%B0%EF%BC%9A-15"><span class="toc-number">16.1.</span> <span class="toc-text">目的描述：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#17-DeclareFaultsRecovered"><span class="toc-number">17.</span> <span class="toc-text">17.DeclareFaultsRecovered</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%AE%E7%9A%84%E6%8F%8F%E8%BF%B0%EF%BC%9A-16"><span class="toc-number">17.1.</span> <span class="toc-text">目的描述：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#18-DisputeWindowedPoSt"><span class="toc-number">18.</span> <span class="toc-text">18.DisputeWindowedPoSt</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%AE%E7%9A%84%E6%8F%8F%E8%BF%B0%EF%BC%9A-17"><span class="toc-number">18.1.</span> <span class="toc-text">目的描述：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%98%E6%96%B9%E6%B3%A8%E9%87%8A%EF%BC%9A"><span class="toc-number">18.2.</span> <span class="toc-text">官方注释：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#19-Exec"><span class="toc-number">19.</span> <span class="toc-text">19.Exec</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%AE%E7%9A%84%E6%8F%8F%E8%BF%B0%EF%BC%9A-18"><span class="toc-number">19.1.</span> <span class="toc-text">目的描述：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%B0%83%E7%94%A8%E5%8F%82%E6%95%B0-5"><span class="toc-number">19.2.</span> <span class="toc-text">调用参数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BF%94%E5%9B%9E%E5%80%BC-5"><span class="toc-number">19.3.</span> <span class="toc-text">返回值</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%98%E6%96%B9%E4%BB%A3%E7%A0%81%E6%B3%A8%E9%87%8A%EF%BC%9A"><span class="toc-number">19.4.</span> <span class="toc-text">官方代码注释：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#20-ExtendSectorExpiration"><span class="toc-number">20.</span> <span class="toc-text">20.ExtendSectorExpiration</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%AE%E7%9A%84%E6%8F%8F%E8%BF%B0%EF%BC%9A-19"><span class="toc-number">20.1.</span> <span class="toc-text">目的描述：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%98%E6%96%B9%E4%BB%A3%E7%A0%81%E6%B3%A8%E9%87%8A%EF%BC%9A-1"><span class="toc-number">20.2.</span> <span class="toc-text">官方代码注释：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#21-PreCommitSector"><span class="toc-number">21.</span> <span class="toc-text">21.PreCommitSector</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%AE%E7%9A%84%E6%8F%8F%E8%BF%B0%EF%BC%9A-20"><span class="toc-number">21.1.</span> <span class="toc-text">目的描述：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%B0%83%E7%94%A8%E5%8F%82%E6%95%B0-6"><span class="toc-number">21.2.</span> <span class="toc-text">调用参数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BF%94%E5%9B%9E%E5%80%BC-6"><span class="toc-number">21.3.</span> <span class="toc-text">返回值</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%98%E6%96%B9%E4%BB%A3%E7%A0%81%E6%B3%A8%E8%A7%A3%EF%BC%9A-6"><span class="toc-number">21.4.</span> <span class="toc-text">官方代码注解：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#22-Propose"><span class="toc-number">22.</span> <span class="toc-text">22.Propose</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%AE%E7%9A%84%E6%8F%8F%E8%BF%B0%EF%BC%9A-21"><span class="toc-number">22.1.</span> <span class="toc-text">目的描述：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%98%E6%96%B9%E4%BB%A3%E7%A0%81%E6%B3%A8%E8%A7%A3%EF%BC%9A-7"><span class="toc-number">22.2.</span> <span class="toc-text">官方代码注解：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#23-ProveCommitSector"><span class="toc-number">23.</span> <span class="toc-text">23.ProveCommitSector</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%AE%E7%9A%84%E6%8F%8F%E8%BF%B0%EF%BC%9A-22"><span class="toc-number">23.1.</span> <span class="toc-text">目的描述：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%B0%83%E7%94%A8%E5%8F%82%E6%95%B0-7"><span class="toc-number">23.2.</span> <span class="toc-text">调用参数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BF%94%E5%9B%9E%E5%80%BC-7"><span class="toc-number">23.3.</span> <span class="toc-text">返回值</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%98%E6%96%B9%E4%BB%A3%E7%A0%81%E6%B3%A8%E8%A7%A3%EF%BC%9A-8"><span class="toc-number">23.4.</span> <span class="toc-text">官方代码注解：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#24-PubkeyAddress"><span class="toc-number">24.</span> <span class="toc-text">24.PubkeyAddress</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%AE%E7%9A%84%E6%8F%8F%E8%BF%B0%EF%BC%9A-23"><span class="toc-number">24.1.</span> <span class="toc-text">目的描述：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#25-PublishStorageDeals"><span class="toc-number">25.</span> <span class="toc-text">25.PublishStorageDeals</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%AE%E7%9A%84%E6%8F%8F%E8%BF%B0%EF%BC%9A-24"><span class="toc-number">25.1.</span> <span class="toc-text">目的描述：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%98%E6%96%B9%E4%BB%A3%E7%A0%81%E6%B3%A8%E8%A7%A3%EF%BC%9A-9"><span class="toc-number">25.2.</span> <span class="toc-text">官方代码注解：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#26-RepayDebt"><span class="toc-number">26.</span> <span class="toc-text">26.RepayDebt</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%AE%E7%9A%84%E6%8F%8F%E8%BF%B0%EF%BC%9A-25"><span class="toc-number">26.1.</span> <span class="toc-text">目的描述：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#27-ReportConsensusFault"><span class="toc-number">27.</span> <span class="toc-text">27.ReportConsensusFault</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%AE%E7%9A%84%E6%8F%8F%E8%BF%B0%EF%BC%9A-26"><span class="toc-number">27.1.</span> <span class="toc-text">目的描述：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%98%E6%96%B9%E4%BB%A3%E7%A0%81%E6%B3%A8%E8%A7%A3%EF%BC%9A-10"><span class="toc-number">27.2.</span> <span class="toc-text">官方代码注解：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#28-Send"><span class="toc-number">28.</span> <span class="toc-text">28.Send</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%AE%E7%9A%84%E6%8F%8F%E8%BF%B0%EF%BC%9A-27"><span class="toc-number">28.1.</span> <span class="toc-text">目的描述：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%B0%83%E7%94%A8%E5%8F%82%E6%95%B0-8"><span class="toc-number">28.2.</span> <span class="toc-text">调用参数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BF%94%E5%9B%9E%E5%80%BC-8"><span class="toc-number">28.3.</span> <span class="toc-text">返回值</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#29-Settle"><span class="toc-number">29.</span> <span class="toc-text">29.Settle</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%AE%E7%9A%84%E6%8F%8F%E8%BF%B0%EF%BC%9A-28"><span class="toc-number">29.1.</span> <span class="toc-text">目的描述：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#30-SubmitWindowedPoSt"><span class="toc-number">30.</span> <span class="toc-text">30.SubmitWindowedPoSt</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%AE%E7%9A%84%E6%8F%8F%E8%BF%B0%EF%BC%9A-29"><span class="toc-number">30.1.</span> <span class="toc-text">目的描述：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%B0%83%E7%94%A8%E5%8F%82%E6%95%B0-9"><span class="toc-number">30.2.</span> <span class="toc-text">调用参数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BF%94%E5%9B%9E%E5%80%BC-9"><span class="toc-number">30.3.</span> <span class="toc-text">返回值</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%98%E6%96%B9%E4%BB%A3%E7%A0%81%E6%B3%A8%E8%A7%A3%EF%BC%9A-11"><span class="toc-number">30.4.</span> <span class="toc-text">官方代码注解：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#31-SwapSigner"><span class="toc-number">31.</span> <span class="toc-text">31.SwapSigner</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%AE%E7%9A%84%E6%8F%8F%E8%BF%B0%EF%BC%9A-30"><span class="toc-number">31.1.</span> <span class="toc-text">目的描述：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%98%E6%96%B9%E4%BB%A3%E7%A0%81%E6%B3%A8%E8%A7%A3%EF%BC%9A-12"><span class="toc-number">31.2.</span> <span class="toc-text">官方代码注解：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#32-TerminateSectors"><span class="toc-number">32.</span> <span class="toc-text">32.TerminateSectors</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%AE%E7%9A%84%E6%8F%8F%E8%BF%B0%EF%BC%9A-31"><span class="toc-number">32.1.</span> <span class="toc-text">目的描述：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%98%E6%96%B9%E4%BB%A3%E7%A0%81%E6%B3%A8%E8%A7%A3%EF%BC%9A-13"><span class="toc-number">32.2.</span> <span class="toc-text">官方代码注解：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#33-UpdateChannelState"><span class="toc-number">33.</span> <span class="toc-text">33.UpdateChannelState</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%AE%E7%9A%84%E6%8F%8F%E8%BF%B0%EF%BC%9A-32"><span class="toc-number">33.1.</span> <span class="toc-text">目的描述：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%98%E6%96%B9%E4%BB%A3%E7%A0%81%E6%B3%A8%E9%87%8A%EF%BC%9A-2"><span class="toc-number">33.2.</span> <span class="toc-text">官方代码注释：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#34-WithdrawBalance-market"><span class="toc-number">34.</span> <span class="toc-text">34.WithdrawBalance (market)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%AE%E7%9A%84%E6%8F%8F%E8%BF%B0%EF%BC%9A-33"><span class="toc-number">34.1.</span> <span class="toc-text">目的描述：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%98%E6%96%B9%E4%BB%A3%E7%A0%81%E6%B3%A8%E8%A7%A3%EF%BC%9A-14"><span class="toc-number">34.2.</span> <span class="toc-text">官方代码注解：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#35-WithdrawBalance-miner"><span class="toc-number">35.</span> <span class="toc-text">35.WithdrawBalance (miner)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%AE%E7%9A%84%E6%8F%8F%E8%BF%B0%EF%BC%9A-34"><span class="toc-number">35.1.</span> <span class="toc-text">目的描述：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%B0%83%E7%94%A8%E5%8F%82%E6%95%B0-10"><span class="toc-number">35.2.</span> <span class="toc-text">调用参数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BF%94%E5%9B%9E%E5%80%BC-10"><span class="toc-number">35.3.</span> <span class="toc-text">返回值</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%98%E6%96%B9%E4%BB%A3%E7%A0%81%E6%B3%A8%E8%A7%A3%EF%BC%9A-15"><span class="toc-number">35.4.</span> <span class="toc-text">官方代码注解：</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/%E6%B6%88%E6%81%AF%E5%88%9D%E6%AD%A5%E5%88%86%E6%9E%90/" title="消息初步分析"><img src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="消息初步分析"/></a><div class="content"><a class="title" href="/%E6%B6%88%E6%81%AF%E5%88%9D%E6%AD%A5%E5%88%86%E6%9E%90/" title="消息初步分析">消息初步分析</a><time datetime="2021-03-24T03:29:41.551Z" title="Created 2021-03-24 11:29:41">2021-03-24</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/%E7%9F%BF%E5%B7%A5%E5%92%8C%E7%94%A8%E6%88%B7%E6%80%8E%E6%A0%B7%E5%90%88%E4%BD%9C%E5%85%B1%E8%B5%A2/" title="矿工和用户怎样合作共赢"><img src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="矿工和用户怎样合作共赢"/></a><div class="content"><a class="title" href="/%E7%9F%BF%E5%B7%A5%E5%92%8C%E7%94%A8%E6%88%B7%E6%80%8E%E6%A0%B7%E5%90%88%E4%BD%9C%E5%85%B1%E8%B5%A2/" title="矿工和用户怎样合作共赢">矿工和用户怎样合作共赢</a><time datetime="2021-03-24T03:29:33.687Z" title="Created 2021-03-24 11:29:33">2021-03-24</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/%E6%89%80%E6%9C%89%E6%B6%88%E6%81%AF%E7%B1%BB%E5%9E%8B/" title="所有消息类型"><img src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="所有消息类型"/></a><div class="content"><a class="title" href="/%E6%89%80%E6%9C%89%E6%B6%88%E6%81%AF%E7%B1%BB%E5%9E%8B/" title="所有消息类型">所有消息类型</a><time datetime="2021-03-24T03:29:25.955Z" title="Created 2021-03-24 11:29:25">2021-03-24</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/%E6%94%AF%E4%BB%98%E9%80%9A%E9%81%93%E7%9B%B8%E5%85%B3/" title="支付通道相关"><img src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="支付通道相关"/></a><div class="content"><a class="title" href="/%E6%94%AF%E4%BB%98%E9%80%9A%E9%81%93%E7%9B%B8%E5%85%B3/" title="支付通道相关">支付通道相关</a><time datetime="2021-03-24T03:29:13.587Z" title="Created 2021-03-24 11:29:13">2021-03-24</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%92%8C%E7%AE%97%E6%B3%95/" title="数据结构和算法"><img src="C:\Users\李德\Desktop\表情\1.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="数据结构和算法"/></a><div class="content"><a class="title" href="/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%92%8C%E7%AE%97%E6%B3%95/" title="数据结构和算法">数据结构和算法</a><time datetime="2021-03-21T15:22:10.000Z" title="Created 2021-03-21 23:22:10">2021-03-21</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2021 By Akesu</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Switch Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>